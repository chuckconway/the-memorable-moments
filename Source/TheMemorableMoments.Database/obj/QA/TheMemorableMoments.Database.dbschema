<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="1.1" DspName="Microsoft.Data.Schema.Sql.Sql100DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False">
	<Header>
		<CustomData Category="ModelCapability">
			<Metadata Name="ModelCapability" Value="Default" />
		</CustomData>
		<CustomData Category="ClrTypesDbSchema" Type="DbSchema">
			<Metadata Name="ClrTypesDbSchema" Value="True" />
		</CustomData>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="False" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="False" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="100" />
		</CustomData>
		<CustomData Category="Permissions" Type="XmlPermissions">
			<Metadata Name="FileName" Value="C:\PROJECTS\THEMEMORABLEMOMENTS\BRANCHES\2.1.0\SOURCE\THEMEMORABLEMOMENTS.DATABASE\PROPERTIES\DATABASE.SQLPERMISSIONS" />
		</CustomData>
	</Header>
	<Model>
		<Element Type="ISql100DatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiPaddingOn" Value="False" />
			<Property Name="IsQuotedIdentifierOn" Value="False" />
			<Property Name="IsCursorDefaultScopeGlobal" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90Route" Name="[AutoCreatedLocal]">
			<Property Name="Address" Value="LOCAL" />
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Album]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[AlbumId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[Description]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[ParentId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[LastModifiedDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Album].[CoverMediaId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Delete From Album 
	Where AlbumId = @AlbumId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Delete].[@AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Delete].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="418" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  Album_Delete&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	--Declare	@UserId int
 -- Declare @AlbumId int

 -- Set	@UserId = 9
 -- Set	@AlbumId = 5

;WITH Hierarchy(AlbumID, Name, ParentID, HLevel)
AS
(
    SELECT AlbumID, Name, ParentID, 0 as HLevel
    FROM Album 
    WHERE AlbumID = @AlbumId

    UNION ALL

    SELECT SubAlbum.AlbumID, SubAlbum.Name, SubAlbum.ParentID, HLevel + 1
    FROM Album SubAlbum
    INNER JOIN Hierarchy ParentDepartment ON 
    SubAlbum.ParentId = ParentDepartment.AlbumID 
)

Select A.AlbumId, HLevel
Into #tempAlbum
FROM  Hierarchy Inner Join Album A ON
Hierarchy.AlbumID = A.AlbumId
Where A.UserId = @UserId
ORDER BY HLevel DESC

--Select * FROM Album A
--Inner Join #tempAlbum T
--	ON T.AlbumId = A.AlbumId

Delete AM
From AlbumMedia AM
Inner Join #tempAlbum T
	ON T.AlbumId = AM.AlbumId

Delete A
FROM Album A
Inner Join #tempAlbum T
	ON T.AlbumId = A.AlbumId

Drop table #tempAlbum

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[AlbumID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[HLevel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[AlbumID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[#tempAlbum]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[#tempAlbum].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[#tempAlbum].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[AlbumID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[AlbumId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[ParentID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[ParentId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[HLevel]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[#tempAlbum]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[#tempAlbum].[AlbumId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[AlbumId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[#tempAlbum].[HLevel]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[CTE1].[Hierarchy].[HLevel]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_DeleteAlbumIncludingSubAlbums].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="1316" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[Album_DeleteAlbumIncludingSubAlbums]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@AlbumId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_DeletePhotoFromAlbumByPhotoId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	Update Album
	Set CoverMediaId = Null
	Where AlbumId = @AlbumId AND
	CoverMediaId = @MediaId

    -- Insert statements for procedure here
	Delete From AlbumMedia
	Where AlbumId = @AlbumId AND
		  MediaId = @MediaId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[CoverMediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeletePhotoFromAlbumByPhotoId].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_DeletePhotoFromAlbumByPhotoId].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_DeletePhotoFromAlbumByPhotoId].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_DeletePhotoFromAlbumByPhotoId].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="708" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Album_DeletePhotoFromAlbumByPhotoId]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[Album] (Name, Description, UserId, ParentId) 
	VALUES (@Name, @Description, @UserId, @ParentId)

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Insert].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Insert].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Insert].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Insert].[@ParentId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Insert].[@Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Insert].[@Description]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Insert].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Insert].[@ParentId]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Insert].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="586" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_Insert]&#xD;&#xA;( &#xD;&#xA;&#x9;@Name nvarchar(50),&#xD;&#xA;&#x9;@Description nvarchar(250),&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@ParentId int = null,&#xD;&#xA;&#x9;@AlbumId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

WITH Hierarchy(AlbumID, Name, ParentID, HLevel)
AS
(
    SELECT AlbumID, Name, ParentID, 0 as HLevel
    FROM Album 
    WHERE AlbumID = @AlbumId

    UNION ALL

    SELECT SubAlbum.AlbumID, SubAlbum.Name, SubAlbum.ParentID, HLevel + 1
    FROM Album SubAlbum
    INNER JOIN Hierarchy ParentDepartment ON 
    SubAlbum.AlbumID = ParentDepartment.ParentID 
)

SELECT A.AlbumID, A.Name, A.ParentID, A.Description, A.UserId, HLevel, 0 as AlbumCount,0 as PhotoCount
FROM  Hierarchy Inner Join Album A ON
Hierarchy.AlbumID = A.AlbumId
Where A.UserId = @UserId

ORDER BY HLevel DESC

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[HLevel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[AlbumID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[AlbumID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[AlbumId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[ParentID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Album].[ParentId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[CTE1].[Hierarchy].[HLevel]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="1020" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_RetrieveAlbumHierarchyByAlbumIdAndUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@AlbumId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_RetrieveAllByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From AlbumView
	Where UserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAllByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveAllByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="439" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_RetrieveAllByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_RetrieveAllByUserIdAndParentId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--Declare @UserId int 
	--Declare @ParentId int 
	--set @UserId = 9
	--set @ParentId = 5

	Select * 
	From AlbumView
	Where UserId = @UserId AND COALESCE(ParentId, 0) = COALESCE(@ParentId, 0)   
	ORder by Name asc
	
	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAllByUserIdAndParentId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveAllByUserIdAndParentId].[@ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveAllByUserIdAndParentId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveAllByUserIdAndParentId].[@ParentId]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="652" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_RetrieveAllByUserIdAndParentId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int, &#xD;&#xA;&#x9;@ParentId int = null&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_RetrieveByPrimaryKeyAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From AlbumView
	Where AlbumId = @AlbumId AND UserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveByPrimaryKeyAndUserId].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveByPrimaryKeyAndUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveByPrimaryKeyAndUserId].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveByPrimaryKeyAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="492" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_RetrieveByPrimaryKeyAndUserId]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_RetrieveTopLevelAlbumsByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From AlbumView A
	Where UserId = @UserId AND COALESCE(ParentId, -1) = -1
	Order By A.Name asc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_RetrieveTopLevelAlbumsByUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_RetrieveTopLevelAlbumsByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="506" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_RetrieveTopLevelAlbumsByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_Search]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	
	IF @AlbumId is NOT NULL
	BEGIN
		
	WITH Hierarchy(AlbumID, Name, ParentID, Description, UserId, PhotoCount, AlbumCount, HLevel)
	AS
	(
		SELECT AlbumID, Name, ParentID, Description, UserId, PhotoCount, ChildAlbumCount, 0 as HLevel
		FROM AlbumView 
		WHERE (AlbumID = @AlbumId AND UserId = @UserId)

		UNION ALL

		SELECT SubAlbum.AlbumID, SubAlbum.Name, SubAlbum.ParentID, SubAlbum.Description, SubAlbum.UserId, SubAlbum.PhotoCount, SubAlbum.ChildAlbumCount, HLevel + 1
		FROM AlbumView SubAlbum
		INNER JOIN Hierarchy ParentDepartment ON 
		SubAlbum.ParentId = ParentDepartment.AlbumID 
	)

	SELECT A.AlbumID, A.Name, A.ParentID, A.Description, A.UserId, HLevel, 0 as ChildAlbumCount,0 as PhotoCount
	FROM  Hierarchy Inner Join Album A ON
	Hierarchy.AlbumID = A.AlbumId
	Where A.Name Like '%' + @SearchText + '%' OR A.[Description] Like '%' + @SearchText + '%'

	ORDER BY A.Name DESC

	END
	ELSE
	BEGIN

	SELECT A.AlbumID, A.Name, A.ParentID, A.Description, A.UserId, ChildAlbumCount,PhotoCount
	FROM  AlbumView A
	Where A.UserId = @UserId AND A.Name Like '%' + @SearchText + '%' OR A.[Description] Like '%' + @SearchText + '%'

	END

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album_Search].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[PhotoCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ChildAlbumCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Search].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[AlbumID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[PhotoCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ChildAlbumCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[HLevel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[AlbumID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[HLevel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Search].[@SearchText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Album_Search].[CTE1].[Hierarchy]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[AlbumID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[AlbumId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[ParentID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[ParentId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[Description]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[Description]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[UserId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[UserId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[PhotoCount]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[PhotoCount]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[AlbumCount]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[AlbumView].[ChildAlbumCount]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Album_Search].[CTE1].[Hierarchy].[HLevel]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Search].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Search].[@AlbumId]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Search].[@SearchText]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="1584" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_Search]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@AlbumId int = null,&#xD;&#xA;&#x9;@SearchText nvarchar(50) = null&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From AlbumView

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="386" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_SelectAll]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From AlbumView
	Where AlbumId = @AlbumId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumView].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_SelectByPrimaryKey].[@AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_SelectByPrimaryKey].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="446" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_SelectByPrimaryKey]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_SetCoverImage]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Update Album
	Set CoverMediaId = @MediaId
	Where AlbumId = @AlbumId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[CoverMediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_SetCoverImage].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_SetCoverImage].[@AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_SetCoverImage].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_SetCoverImage].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="575" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Album_SetCoverImage&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update Album 
	SET 
	Name = @Name,
	Description = @Description,
	UserId = @UserId,
	ParentId = @ParentId
 
	Where AlbumId = @AlbumId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Update].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Update].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Update].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Update].[@ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_Update].[@AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Update].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Update].[@Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Update].[@Description]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Update].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_Update].[@ParentId]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="611" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Album_Update]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@Name nvarchar(50),&#xD;&#xA;&#x9;@Description nvarchar(250),&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@ParentId int = null&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Album_UpdateMediaPosition]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Update AlbumMedia Set Position = @Position
	From AlbumMedia inner join 
	(
		Select AlbumId 
		From Album 
		Where Album.AlbumId = @AlbumId AND Album.UserId = @UserId
	) A On
	AlbumMedia.AlbumId = A.AlbumId
	Where AlbumMedia.MediaId = @MediaId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_UpdateMediaPosition].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_UpdateMediaPosition].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[Position]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_UpdateMediaPosition].[@Position]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album_UpdateMediaPosition].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_UpdateMediaPosition].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_UpdateMediaPosition].[@Position]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_UpdateMediaPosition].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Album_UpdateMediaPosition].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="803" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Album_UpdateMediaPosition]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Position int,&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@AlbumId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[AlbumMedia]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[AlbumMedia].[AlbumId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[AlbumMedia].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[AlbumMedia].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[AlbumMedia].[Position]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[AlbumMedia_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Delete From AlbumMedia 
	Where AlbumId = @AlbumId And MediaId = @MediaId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_Delete].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_Delete].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_Delete].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_Delete].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="467" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  AlbumMedia_Delete&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[AlbumMedia_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[AlbumMedia] (AlbumId, MediaId) 
	VALUES (@AlbumId, @MediaId)

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_Insert].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_Insert].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_Insert].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_Insert].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="481" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[AlbumMedia_Insert]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[AlbumMedia_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select AlbumId, MediaId 
	From AlbumMedia

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="399" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  AlbumMedia_SelectAll&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[AlbumMedia_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select AlbumId, MediaId 
	From AlbumMedia 
	Where AlbumId = @AlbumId And MediaId = @MediaId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_SelectByPrimaryKey].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_SelectByPrimaryKey].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_SelectByPrimaryKey].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_SelectByPrimaryKey].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="499" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  AlbumMedia_SelectByPrimaryKey&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[AlbumMedia_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update AlbumMedia 
	SET 	AlbumId = @AlbumId,
	MediaId = @MediaId
 
	Where AlbumId = @AlbumId And MediaId = @MediaId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_Update].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia_Update].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_Update].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[AlbumMedia_Update].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="513" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 14, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  AlbumMedia_Update&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[AlbumView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     A.AlbumId, A.Name, A.Description, A.UserId, A.ParentId, A.CoverMediaId, COALESCE (C.AlbumCount, 0) AS ChildAlbumCount, COALESCE (AM.PhotoCount, 0) 
                      AS PhotoCount
FROM         dbo.Album AS A LEFT OUTER JOIN
                          (SELECT     COUNT(AlbumId) AS AlbumCount, ParentId
                            FROM          dbo.Album
                            GROUP BY ParentId) AS C ON A.AlbumId = C.ParentId LEFT OUTER JOIN
                          (SELECT     COUNT(AlbumId) AS PhotoCount, AlbumId
                            FROM          dbo.AlbumMedia
                            GROUP BY AlbumId) AS AM ON A.AlbumId = AM.AlbumId]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[AlbumId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Album].[AlbumId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[Name]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Album].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[Description]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Album].[Description]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Album].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[ParentId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Album].[ParentId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[CoverMediaId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Album].[CoverMediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[ChildAlbumCount]" />
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[AlbumView].[PhotoCount]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[CoverMediaId]" />
				</Entry>
				<Entry />
				<Entry />
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="711" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.AlbumView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Comment]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[CommentId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[Name]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[Email]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[SiteUrl]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[Ip]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[UserAgent]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[CommentStatus]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[Text]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[CommentDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[UserId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[ParentId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Delete From Comment 
	Where CommentId = @CommentId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Delete].[@CommentId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Delete].[@CommentId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="426" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  Comment_Delete&#xD;&#xA;( &#xD;&#xA;&#x9;@CommentId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[Comment] (Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text],  CommentDate, UserId, ParentId, MediaId) 
	VALUES (@Name, @Email, @SiteUrl, @Ip, @UserAgent, @CommentStatus, @Text, @CommentDate, @UserId, @ParentId, @MediaId)
	
	Set @Identity =(Select @@IDENTITY)
	return @Identity	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Insert].[@Identity]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@SiteUrl]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@Ip]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@UserAgent]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@CommentStatus]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@Text]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@CommentDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@ParentId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Insert].[@Identity]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="946" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_Insert]&#xD;&#xA;( &#xD;&#xA;&#x9;@Name nvarchar(100),&#xD;&#xA;&#x9;@Email nvarchar(255),&#xD;&#xA;&#x9;@SiteUrl nvarchar(100),&#xD;&#xA;&#x9;@Ip nvarchar(100),&#xD;&#xA;&#x9;@UserAgent nvarchar(500),&#xD;&#xA;&#x9;@CommentStatus nvarchar(50),&#xD;&#xA;&#x9;@Text nvarchar(max),&#xD;&#xA;&#x9;@CommentDate datetime,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@ParentId int,&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@Identity int output&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_RetrieveAllByMediaId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select CommentId, Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text], CommentDate, UserId, ParentId, MediaId 
	From Comment
	Where MediaId = @MediaId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveAllByMediaId].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_RetrieveAllByMediaId].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="378" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_RetrieveAllByMediaId]&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_RetrieveCommentByStatusAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From CommentView
	Where CommentStatus = @CommentStatus
	And MediaUserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CommentView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CommentView].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveCommentByStatusAndUserId].[@CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CommentView].[MediaUserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveCommentByStatusAndUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_RetrieveCommentByStatusAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_RetrieveCommentByStatusAndUserId].[@CommentStatus]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="527" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_RetrieveCommentByStatusAndUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@CommentStatus nvarchar(50)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_RetrieveCommentsByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select CommentId, Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text], CommentDate, Media.UserId, ParentId, Media.MediaId 
	From Comment Inner Join Media On
	Comment.MediaId = Media.MediaId
	Where Media.UserId = @UserId AND CommentStatus <> 'Deleted'

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveCommentsByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_RetrieveCommentsByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="653" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_RetrieveCommentsByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--declare @UserId int
	--set @UserId = 9
	
	DECLARE @CommentStatus TABLE
	(
	  CommentStatus nvarchar(50),
	  MediaCount int
	)
	
	--Approved
	Insert Into @CommentStatus(CommentStatus, MediaCount)
	Select 'Approved' as CommentStatus, COUNT(*) as MediaCount From Comment Where UserId = @UserId AND CommentStatus = 'Approved'
	
	--Pending
	Insert Into @CommentStatus(CommentStatus, MediaCount)
	Select 'Pending' as CommentStatus, COUNT(*) as MediaCount From Comment Where UserId = @UserId AND CommentStatus = 'Pending'
	
	--Deleted
	Insert Into @CommentStatus(CommentStatus, MediaCount)
	Select 'Deleted' as CommentStatus, COUNT(*) as MediaCount From Comment Where UserId = @UserId AND CommentStatus = 'Deleted'
	
	--Spam
	Insert Into @CommentStatus(CommentStatus, MediaCount)
	Select 'Spam' as CommentStatus, COUNT(*) as MediaCount From Comment Where UserId = @UserId AND CommentStatus = 'Spam'

	--Select CommentId, Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text],  CommentDate, UserId, ParentId, MediaId 
	--From Comment 
	--Where CommentId = @CommentId 
	
	Select * from @CommentStatus
	
	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@CommentStatus].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@CommentStatus].[MediaCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@CommentStatus]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@CommentStatus].[CommentStatus]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@CommentStatus].[MediaCount]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_RetrieveCommentStatusCountByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="1538" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_RetrieveCommentStatusCountByUserId]&#xD;&#xA;( &#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_RetrieveRecent5CommentsByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(5) CommentId, Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text], CommentDate, M.UserId, ParentId, M.MediaId 
	From Comment C Inner Join Media M On M.MediaId = C.MediaId
	Where M.UserId = @UserId AND CommentStatus = 'Approved'
	Order by CommentDate

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_RetrieveRecent5CommentsByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_RetrieveRecent5CommentsByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="670" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_RetrieveRecent5CommentsByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select CommentId, Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text], CommentDate, UserId, ParentId, MediaId 
	From Comment

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="492" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_SelectAll]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select CommentId, Name, Email, SiteUrl, Ip, UserAgent, CommentStatus, [Text],  CommentDate, UserId, ParentId, MediaId 
	From Comment 
	Where CommentId = @CommentId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_SelectByPrimaryKey].[@CommentId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_SelectByPrimaryKey].[@CommentId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="560" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_SelectByPrimaryKey]&#xD;&#xA;( &#xD;&#xA;&#x9;@CommentId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update Comment 
	SET 	
	Name = @Name,
	Email = @Email,
	SiteUrl = @SiteUrl,
	Ip = @Ip,
	UserAgent = @UserAgent,
	CommentStatus = @CommentStatus,
	[Text] = @Text,
	CommentDate = @CommentDate,
	UserId = @UserId,
	ParentId = @ParentId,
	MediaId = @MediaId
 
	Where CommentId = @CommentId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_Update].[@CommentId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@CommentId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@SiteUrl]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@Ip]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@UserAgent]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@CommentStatus]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@Text]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@CommentDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@ParentId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_Update].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="930" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Comment_Update]&#xD;&#xA;( &#xD;&#xA;&#x9;@CommentId int,&#xD;&#xA;&#x9;@Name nvarchar(100),&#xD;&#xA;&#x9;@Email nvarchar(255),&#xD;&#xA;&#x9;@SiteUrl nvarchar(100),&#xD;&#xA;&#x9;@Ip nvarchar(100),&#xD;&#xA;&#x9;@UserAgent nvarchar(500),&#xD;&#xA;&#x9;@CommentStatus nvarchar(50),&#xD;&#xA;&#x9;@Text nvarchar(max),&#xD;&#xA;&#x9;@CommentDate datetime,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@ParentId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Comment_UpdateStatus]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update Comment 
	SET CommentStatus = @CommentStatus
	From Comment C Inner Join Media M
	On C.MediaId = M.MediaId 
	Where C.CommentId = @CommentId AND M.UserId = @UserId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_UpdateStatus].[@CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_UpdateStatus].[@CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment_UpdateStatus].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_UpdateStatus].[@CommentId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_UpdateStatus].[@CommentStatus]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Comment_UpdateStatus].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="173" />
				<Property Name="Length" Value="607" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Sunday, November 15, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[Comment_UpdateStatus]&#xD;&#xA;( &#xD;&#xA;&#x9;@CommentId int,&#xD;&#xA;&#x9;@CommentStatus nvarchar(50),&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[CommentView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     dbo.Comment.CommentId, dbo.Comment.Name, dbo.Comment.Email, dbo.Comment.SiteUrl, dbo.Comment.Ip, dbo.Comment.UserAgent, dbo.Comment.CommentStatus, 
                      dbo.Comment.Text, dbo.Comment.CommentDate, dbo.Comment.UserId, dbo.Comment.ParentId, dbo.Media.UserId AS MediaUserId, dbo.Comment.MediaId
FROM         dbo.Comment INNER JOIN
                      dbo.Media ON dbo.Comment.MediaId = dbo.Media.MediaId]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[CommentId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[CommentId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[Name]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[Email]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[Email]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[SiteUrl]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[SiteUrl]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[Ip]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[Ip]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[UserAgent]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[UserAgent]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[CommentStatus]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[CommentStatus]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[Text]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[Text]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[CommentDate]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[CommentDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[ParentId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[ParentId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[MediaUserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CommentView].[MediaId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Comment].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[SiteUrl]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Ip]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserAgent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[Text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[ParentId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="465" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.CommentView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Configuration]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[ConfigurationId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[SiteName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[SiteTagLine]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[Membership]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[ThumbNailHeight]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[ThumbNailWidth]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[WebHeight]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Configuration].[WebWidth]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Configuration_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select ConfigurationId, SiteName, SiteTagLine, Membership, ThumbNailHeight, ThumbNailWidth, WebHeight, WebWidth 
	From Configuration

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Configuration]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[ConfigurationId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[SiteName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[SiteTagLine]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[Membership]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[ThumbNailHeight]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[ThumbNailWidth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[WebHeight]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Configuration].[WebWidth]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="490" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  Configuration_SelectAll&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[CurrentMediaDetailsView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     TOP (1) Title, Description, Tags, MediaYear, MediaDay, MediaMonth, MediaId, InsertDate, UserId
FROM         dbo.MediaLedger
ORDER BY InsertDate]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[Title]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Title]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[Description]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Description]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[Tags]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Tags]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[MediaYear]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaYear]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[MediaDay]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaDay]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[MediaMonth]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaMonth]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[MediaId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[InsertDate]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[InsertDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[CurrentMediaDetailsView].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[UserId]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="201" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.CurrentMediaDetailsView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Album_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Album].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Album_LastModifiedDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Album].[LastModifiedDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_AlbumMedia_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[AlbumMedia].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Configuration_ConfigurationId]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(newid())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Configuration]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Configuration].[ConfigurationId]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_File_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[File].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Friend_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Friend].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Invitation_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Invitation]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Invitation].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Invitation_Sent]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Invitation]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Invitation].[Sent]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Media_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Media_UploadStatus]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[('Uploading')]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Media].[UploadStatus]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_MediaLedger_InsertDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_MediaUploadBatch_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaUploadBatch]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[MediaUploadBatch].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_MediaViewed_FirstViewed]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaViewed]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[MediaViewed].[FirstViewed]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_MediaViewed_ViewCount]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaViewed]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[MediaViewed].[ViewCount]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_MediaViewed_ViewDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaViewed]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[MediaViewed].[LastViewed]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Photo_Hidden]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_RecentActivity_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[RecentActivity]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[RecentActivity].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_TagMedia_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TagMedia].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Token_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Token]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Token].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Token_IsValid]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Token]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Token].[IsValid]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_User_Deleted]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[User].[Deleted]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_User_EnableEmails]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_User_MaxInvitation]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((5))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[User].[MaxInvitations]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_User_WebViewMaxHeight]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((800))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxHeight]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_User_WebViewMaxWidth]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((800))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxWidth]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_Viewed_ViewedDateTime]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Viewed]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Viewed].[ViewedDateTime]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90DefaultConstraint" Name="[dbo].[DF_WaitingList_CreateDate]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getutcdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WaitingList]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WaitingList].[CreateDate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Exif]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Exif].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Exif].[Key]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Exif].[Value]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100TableType" Name="[dbo].[ExifCollection]">
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100TableTypeSimpleColumn" Name="[dbo].[ExifCollection].[MediaId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100TableTypeSimpleColumn" Name="[dbo].[ExifCollection].[Key]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100TableTypeSimpleColumn" Name="[dbo].[ExifCollection].[Value]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[File]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[File].[FileId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[File].[FilePath]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[File].[FileExtension]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[File].[OriginalFileName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[File].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Delete From [File]
	Where FileId = @FileId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Delete].[@FileId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Delete].[@FileId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="411" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  File_Delete&#xD;&#xA;( &#xD;&#xA;&#x9;@FileId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[File] (FilePath, FileExtension, OriginalFileName, CreateDate) 
	VALUES (@FilePath, @FileExtension, @OriginalFileName, GETUTCDATE())	

	Set @Identity =(Select @@IDENTITY)	
	Insert INTO MediaFile(MediaId, FileId, MediaFormat, MediaType) VALUES (@MediaId, @Identity, @MediaFormat, @MediaType) 
	
	return @Identity

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@Identity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaFormat]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@MediaFormat]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Insert].[@MediaType]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@FilePath]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@FileExtension]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@OriginalFileName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@Identity]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@MediaFormat]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Insert].[@MediaType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="876" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  File_Insert&#xD;&#xA;( &#xD;&#xA;&#x9;@FilePath nvarchar(255),&#xD;&#xA;&#x9;@FileExtension nvarchar(10),&#xD;&#xA;&#x9;@OriginalFileName nvarchar(200),&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@Identity int output,&#xD;&#xA;&#x9;@MediaFormat nvarchar(50),&#xD;&#xA;&#x9;@MediaType nvarchar(50)&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_RetrieveByMediaId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT  * FROM FileView where MediaId = @MediaId
                      
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[FileView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FileView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_RetrieveByMediaId].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_RetrieveByMediaId].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="566" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE File_RetrieveByMediaId &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_RetrieveByMediaIdCollection]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT  * FROM FileView FV
	Inner join @Ids I
		ON  I.Id = FV.MediaId --  where MediaId = @MediaId
                      
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[FileView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_RetrieveByMediaIdCollection].[@Ids]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_RetrieveByMediaIdCollection].[@Ids].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FileView].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[File_RetrieveByMediaIdCollection].[@Ids]" Disambiguator="4">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[File_RetrieveByMediaIdCollection].[@Ids].[Id]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_RetrieveByMediaIdCollection].[@Ids]">
						<Property Name="IsReadOnly" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References Name="[dbo].[IdCollection]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="650" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE [dbo].[File_RetrieveByMediaIdCollection] &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Ids IdCollection ReadOnly&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select FileId, FilePath, FileExtension, OriginalFileName, CreateDate 
	From [File]

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[CreateDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="431" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  File_SelectAll&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select FileId, FilePath, FileExtension, OriginalFileName, CreateDate 
	From [File]
	Where FileId = @FileId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_SelectByPrimaryKey].[@FileId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_SelectByPrimaryKey].[@FileId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="485" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  File_SelectByPrimaryKey&#xD;&#xA;( &#xD;&#xA;&#x9;@FileId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[File_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update [File]
	SET
	FilePath = @FilePath,
	FileExtension = @FileExtension,
	OriginalFileName = @OriginalFileName
 
	Where FileId = @FileId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Update].[@FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Update].[@FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Update].[@OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File_Update].[@FileId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Update].[@FileId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Update].[@FilePath]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Update].[@FileExtension]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[File_Update].[@OriginalFileName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="605" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  File_Update&#xD;&#xA;( &#xD;&#xA;&#x9;@FileId int,&#xD;&#xA;&#x9;@FilePath nvarchar(255),&#xD;&#xA;&#x9;@FileExtension nvarchar(10),&#xD;&#xA;&#x9;@OriginalFileName nvarchar(200)&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[FileView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     dbo.MediaFile.MediaType, dbo.MediaFile.MediaFormat, dbo.[File].OriginalFileName, dbo.[File].FileExtension, dbo.[File].FilePath, dbo.[File].FileId, 
                      dbo.MediaFile.MediaId
FROM         dbo.[File] INNER JOIN
                      dbo.MediaFile ON dbo.[File].FileId = dbo.MediaFile.FileId]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[MediaType]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaFile].[MediaType]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[MediaFormat]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaFile].[MediaFormat]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[OriginalFileName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[File].[OriginalFileName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[FileExtension]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[File].[FileExtension]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[FilePath]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[File].[FilePath]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[FileId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[File].[FileId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FileView].[MediaId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaFile].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaFormat]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[OriginalFileName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileExtension]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FilePath]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaId]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="350" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.FileView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Album_User]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_AlbumMedia_Album]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_AlbumMedia_Media]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Comment_Media]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Exif_Media]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Exif].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Exif]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Friend_User]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Friend_User1]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Friend].[FriendId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Invitation_User]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Invitation].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Invitation]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_MediaFile_File]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[MediaFile].[FileId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaFile]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_MediaFile_Media]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaFile]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_TagMedia_Media]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_TagMedia_Tag]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Viewed_Media]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Viewed].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Viewed]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90ForeignKeyConstraint" Name="[dbo].[FK_Viewed_User]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Viewed].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Viewed]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Friend]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Friend].[FriendId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Friend].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Friend].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Friend_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Delete From Friend
	Where FriendId = @FriendId AND UserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_Delete].[@FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_Delete].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_Delete].[@FriendId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_Delete].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="455" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 28, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  Friend_Delete&#xD;&#xA;(&#xD;&#xA;&#x9;@FriendId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Friend_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[Friend] (FriendId, UserId, CreateDate) 
	VALUES (@FriendId, @UserId, GETUTCDATE())

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_Insert].[@FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_Insert].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_Insert].[@FriendId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_Insert].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="499" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 28, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Friend_Insert]&#xD;&#xA;( &#xD;&#xA;&#x9;@FriendId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Friend_RetrieveFriendById]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From FriendView
	Where FriendId = @FriendId AND UserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[FriendView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FriendView].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_RetrieveFriendById].[@FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FriendView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_RetrieveFriendById].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_RetrieveFriendById].[@FriendId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_RetrieveFriendById].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="482" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 28, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Friend_RetrieveFriendById]&#xD;&#xA;(&#xD;&#xA;&#x9;@FriendId int, &#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Friend_RetrievesFriendByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From FriendView
	Where UserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[FriendView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FriendView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_RetrievesFriendByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_RetrievesFriendByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="175" />
				<Property Name="Length" Value="444" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Saturday, November 28, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[Friend_RetrievesFriendByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Friend_SearchByText]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--declare @Search nvarchar(250)
	--declare @UserId int
   
 --  Set @Search = 'c'
 --  Set @UserId = 10
	
	-- Insert statements for procedure here
	SELECT     U.FirstName, U.LastName, U.Email, U.DisplayName, U.Username, U.UserId as FriendId,
							 (SELECT   COUNT(Media.MediaId)
								FROM          Media
								WHERE      UserId = U.UserId) AS PhotoCount,
							 COALESCE((SELECT  TOP (1) ROW_NUMBER() OVER (ORDER BY TagId ASC) AS C 
	FROM         (SELECT     TagMedia.MediaId, TM.TagId
						   FROM          (SELECT     TagId
												   FROM          TagMedia
												   GROUP BY TagId) TM INNER JOIN
												  TagMedia ON TM.TagId = TagMedia.TagId INNER JOIN
												  Media ON TagMedia.MediaId = Media.MediaId
						   WHERE      UserId = U.UserId) E
	GROUP BY TagId
	ORDER BY C DESC), 0) AS TagCount,
		(SELECT     COUNT(*) AS C
		  FROM          Friend
		  WHERE      UserId = U.UserId) AS FriendCount
	FROM [User] U left join Friend F On
	U.UserId = F.FriendId 
	Where U.UserId <> @UserId AND U.UserId Not in (Select FriendId as UserId From Friend Where UserId = @UserId) AND 
					([FirstName] LIKE '%' + @Search + '%' 
					OR [LastName] LIKE '%' + @Search + '%' 
					OR Email LIKE '%' + @Search + '%' 
					OR DisplayName LIKE '%' + @Search + '%'
					OR Username LIKE '%' + @Search + '%')				
			


END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_SearchByText].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend_SearchByText].[@Search]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_SearchByText].[@Search]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Friend_SearchByText].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1845" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Friend_SearchByText]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Search nvarchar(250),&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[FriendView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     U.FirstName, U.LastName, U.Email, U.DisplayName, U.Username, dbo.Friend.UserId, dbo.Friend.FriendId,
                          (SELECT     COUNT(Media.MediaId)
                            FROM          Media
                            WHERE      UserId = U.UserId) AS PhotoCount,
                         COALESCE(  (SELECT     TOP (1) ROW_NUMBER() OVER (ORDER BY TagId ASC) AS C
FROM         (SELECT     TagMedia.MediaId, TM.TagId
                       FROM          (SELECT     TagId
                                               FROM          TagMedia
                                               GROUP BY TagId) TM INNER JOIN
                                              TagMedia ON TM.TagId = TagMedia.TagId INNER JOIN
                                              Media ON TagMedia.MediaId = Media.MediaId
                       WHERE      UserId = U.UserId) E
GROUP BY TagId
ORDER BY C DESC), 0 ) AS TagCount,
    (SELECT     COUNT(*) AS C
      FROM          Friend
      WHERE      UserId = U.UserId) AS FriendCount
FROM         [User] U INNER JOIN
                      dbo.Friend ON U.UserId = dbo.Friend.FriendId]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[FirstName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[FirstName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[LastName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[LastName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[Email]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Email]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[DisplayName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[DisplayName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[Username]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Username]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Friend].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[FriendId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Friend].[FriendId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[PhotoCount]" />
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[TagCount]" />
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[FriendView].[FriendCount]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1191" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.FriendView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100TableType" Name="[dbo].[IdCollection]">
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100TableTypeSimpleColumn" Name="[dbo].[IdCollection].[Id]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[InsertTagWithMediaId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
Declare @TagId int
if EXISTS(SELECT TG.TagId, TG.TagName, TG.MediaId
	FROM  (
           Select dbo.Tag.TagId, dbo.Tag.TagName, dbo.TagMedia.MediaId From dbo.Tag INNER JOIN
					dbo.TagMedia ON dbo.Tag.TagId = dbo.TagMedia.TagId
					GROUP BY dbo.Tag.TagId, dbo.Tag.TagName, dbo.TagMedia.MediaId
					
				)TG
			WHERE  TG.TagName = @TagName AND MediaId = @MediaId
		)
	Begin
		 Set @tagId = (
						SELECT TG.TagId
						FROM	(
									Select dbo.Tag.TagId, dbo.Tag.TagName, dbo.TagMedia.MediaId From  dbo.Tag INNER JOIN
									dbo.TagMedia ON dbo.Tag.TagId = dbo.TagMedia.TagId
									GROUP BY dbo.Tag.TagId, dbo.Tag.TagName, dbo.TagMedia.MediaId
								) TG
						WHERE  TG.TagName = @TagName AND MediaId = @MediaId
					   )

		Insert Into TagMedia(TagID,MediaId) Values (@tagId, @MediaId)
	End
ELSE
	Begin
		Insert INTO Tag(TagName)Values(@TagName)
		Declare @newTagId int
		set @newTagId = (Select @@IDENTITY)

		Insert Into TagMedia(TagID,MediaId) Values (@newTagId, @MediaId)
	End
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[InsertTagWithMediaId].[@TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[InsertTagWithMediaId].[@mediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[InsertTagWithMediaId].[@TagName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[InsertTagWithMediaId].[@mediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1321" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE InsertTagWithMediaId &#xD;&#xA;(&#xD;&#xA;&#x9;@TagName nvarchar(100),&#xD;&#xA;&#x9;@mediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Invitation]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Invitation].[InvitationId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Invitation].[Email]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Invitation].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Invitation].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Invitation].[Sent]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Invitation_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Insert INTO Invitation(Email, UserId)VALUES(@Email, @UserId)	
	
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Invitation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation_Insert].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation_Insert].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Invitation_Insert].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Invitation_Insert].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="580" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Invitation_Insert&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Email nvarchar(250),&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Invitation_UserInvitationsRemaining]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
    
    Declare @InvitationCount int
    Set @InvitationCount = 
    (
		Select COUNT(*) 
		From Invitation
		Where Invitation.UserId = @UserId
	)
    
    Declare @MaxInvitations int
	Set @MaxInvitations =
	(
		Select MaxInvitations 
		From dbo.[User]
		Where dbo.[User].UserId = @UserId
	)
	
	Declare @Remaining int
	Set @Remaining = (@MaxInvitations - @InvitationCount)
	
	IF (@Remaining < 0)
	BEGIN
	   set	@Remaining = 0
	END
	
	Select @Remaining as RemainingInvitations

	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Invitation_UserInvitationsRemaining].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[MaxInvitations]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Invitation_UserInvitationsRemaining].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1011" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Invitation_UserInvitationsRemaining &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Location]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[LocationId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[LocationName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[Latitude]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="13" />
									<Property Name="Precision" Value="26" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[numeric]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[Longitude]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="13" />
									<Property Name="Precision" Value="26" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[numeric]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[Zoom]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Location].[MapTypeId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Location_AutocompleteSearch]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    Select Top(10) *
    From Location
    Where UserId = @UserId 
    AND LocationName Like '%' + @Text + '%'
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_AutocompleteSearch].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[LocationName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_AutocompleteSearch].[@Text]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_AutocompleteSearch].[@Text]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_AutocompleteSearch].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="590" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Location_AutocompleteSearch&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Text nvarchar(100),&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Location_Save]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	IF @LocationId > 0
	BEGIN
		Update Location
		Set LocationName = @LocationName,
			Latitude = @Latitude,
			Longitude = @Longitude,
			UserId = @UserId,
			Zoom = @Zoom,
			MapTypeId = @MapTypeId
		Where LocationId = @LocationId
	END
	ELSE
	BEGIN
	
		IF EXists(Select * 
			      From Location 
			      Where LocationName = @LocationName
			      AND UserId = @UserId)
		BEGIN
				Update Location
				Set LocationName = @LocationName,
					Latitude = @Latitude,
					Longitude = @Longitude,
					UserId = @UserId,
					Zoom = @Zoom,
					MapTypeId = @MapTypeId
			     Where LocationName = @LocationName
			     AND UserId = @UserId		
		END 
		ELSE
		BEGIN
		
			Insert Into Location (LocationName, Latitude, Longitude, UserId, Zoom, MapTypeId)
			Values (@LocationName, @Latitude, @Longitude, @UserId, @Zoom, @MapTypeId)
		
		END	
	END
    
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Location_Save].[@LocationId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[LocationName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_Save].[@LocationName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[Latitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_Save].[@Latitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[Longitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_Save].[@Longitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_Save].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[Zoom]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_Save].[@Zoom]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[MapTypeId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_Save].[@MapTypeId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[LocationId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[LocationName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@LocationId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@LocationName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@Latitude]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="15" />
									<Property Name="Precision" Value="26" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[numeric]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@Longitude]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="15" />
									<Property Name="Precision" Value="26" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[numeric]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@Zoom]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Location_Save].[@MapTypeId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1473" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Location_Save&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@LocationId int,&#xD;&#xA;&#x9;@LocationName nvarchar(100),&#xD;&#xA;&#x9;@Latitude numeric(26, 15),&#xD;&#xA;&#x9;@Longitude numeric(26, 15),&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Zoom tinyint,&#xD;&#xA;&#x9;@MapTypeId nvarchar(50)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Media]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Media].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Media].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Media].[Status]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Media].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Media].[UploadStatus]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
BEGIN TRY
	Begin Transaction
	
	--CREATE TABLE #tempFile
	--(
	--   FileId INT
	--)
	
	Select F.FileId 
	INTO #tempFile
	From [File] F
	Inner Join MediaFile MF
		On F.FileId = MF.FileId
	Where MF.MediaId = @MediaId
	
	Delete From MediaFile
	Where MediaId = @MediaId
	
	Delete F
	From [File] F
	Inner Join #tempFile MF
		On F.FileId = MF.FileId 	
	
	Delete From MediaFile
	Where MediaId = @MediaId	
	
	
	Delete From TagMedia
	Where MediaId = @MediaId
	
	Delete From Comment
	Where MediaId = @MediaId
	
	Delete From AlbumMedia
	Where MediaId = @MediaId
	
	Delete From Media 
	Where MediaId = @MediaId AND UserId = @UserId
	
	drop table #tempFile
		
	Commit
	
	END TRY
BEGIN CATCH
	Rollback
	DECLARE @ErrorMessage NVARCHAR(4000);
    DECLARE @ErrorSeverity INT;
    DECLARE @ErrorState INT;

    SELECT 
        @ErrorMessage = ERROR_MESSAGE(),
        @ErrorSeverity = ERROR_SEVERITY(),
        @ErrorState = ERROR_STATE();

    -- Use RAISERROR inside the CATCH block to return error
    -- information about the original error that caused
    -- execution to jump to the CATCH block.
    RAISERROR (@ErrorMessage, -- Message text.
               @ErrorSeverity, -- Severity.
               @ErrorState -- State.
               );
END CATCH

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Delete].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaFile].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Delete].[#tempFile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[File].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Delete].[#tempFile].[FileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Delete].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Media_Delete].[#tempFile]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Media_Delete].[#tempFile].[FileId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[File].[FileId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Delete].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Delete].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="1690" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_Delete]&#xD;&#xA;( &#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[Media] (UserId, Status) 
	VALUES (@UserId, @Status)
	
	Set @Identity =(Select @@IDENTITY)
	
	Insert INTO MediaLedger(Title, Description, Tags, MediaDay, MediaYear, MediaMonth, MediaId, UserId)
	VALUES(@Title, @Description, @Tags, @MediaDay, @MediaYear, @MediaMonth, @Identity, @UserId)
	
	return @Identity	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@Identity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Insert].[@MediaMonth]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@Title]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@Description]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="550" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@MediaYear]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@MediaMonth]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@MediaDay]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@Status]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@Tags]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Insert].[@Identity]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="931" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_Insert]&#xD;&#xA;( &#xD;&#xA;&#x9;@Title nvarchar(100),&#xD;&#xA;&#x9;@Description nvarchar(550),&#xD;&#xA;&#x9;--@TimesViewed int,&#xD;&#xA;&#x9;@MediaYear int = null,&#xD;&#xA;&#x9;@MediaMonth int = null,&#xD;&#xA;&#x9;@MediaDay int = null,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Status nvarchar(50),&#xD;&#xA;&#x9;@Tags nvarchar(250),&#xD;&#xA;&#x9;@Identity int output&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RemoveTag]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Delete TM
	From Tag T
	Inner Join TagMedia TM
		ON T.TagId = TM.TagId
	Where TM.MediaId = @MediaId
	AND TagName = @TagName
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RemoveTag].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RemoveTag].[@TagName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RemoveTag].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RemoveTag].[@TagName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="639" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Media_RemoveTag&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@TagName nvarchar(100)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetreiveMediaStatusesCountByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select StatusCount, Status From
		(
			Select COUNT(Status) as StatusCount, Status, UserId
			From MediaView 
			GRoup By Status, UserId
		) T
	Where T.UserId = @UserID
	
	--Union ALL
	
	--Select COUNT(*)as StatusCount,  null as Status
	--From MediaView
	--Where UserId = @UserID
	
	--Union All
	
	--Select COUNT(*)as StatusCount, 'Untagged' as Status
	--From MediaView
	--Where [Status] = 'UnPublished' AND LEN(Tags) = 0 AND UserId = @UserID
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetreiveMediaStatusesCountByUserId].[@UserID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetreiveMediaStatusesCountByUserId].[@UserID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="861" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetreiveMediaStatusesCountByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserID int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_Retrieve25RecentPhotosByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(50) *
	From MediaView 
	Where UserId = @UserId AND MediaView.Status = @Visibility
	Order by CreateDate desc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Retrieve25RecentPhotosByUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Retrieve25RecentPhotosByUserId].[@Visibility]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[CreateDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Retrieve25RecentPhotosByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Retrieve25RecentPhotosByUserId].[@Visibility]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="556" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_Retrieve25RecentPhotosByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Visibility nvarchar(50) = 'Public'&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_Retrieve33RecentPhotosByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(17) *
	From MediaView 
	Where UserId = @UserId AND MediaView.Status = @Visibility
	Order by CreateDate desc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Retrieve33RecentPhotosByUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Retrieve33RecentPhotosByUserId].[@Visibility]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[CreateDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Retrieve33RecentPhotosByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Retrieve33RecentPhotosByUserId].[@Visibility]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="556" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_Retrieve33RecentPhotosByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Visibility nvarchar(50) = 'Public'&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveByAlbumIdAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From MediaView Inner Join AlbumMedia ON
	MediaView.MediaId = AlbumMedia.MediaId Inner Join Album ON
	Album.AlbumId = AlbumMedia.AlbumId	
	Where Album.AlbumId = @AlbumId AND MediaView.UserId = @UserId
	Order By CASE WHEN AlbumMedia.Position IS NULL THEN 1 ELSE 0 END, AlbumMedia.Position
	--Order By AlbumMedia.Position asc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByAlbumIdAndUserId].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByAlbumIdAndUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[Position]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByAlbumIdAndUserId].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByAlbumIdAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="750" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrieveByAlbumIdAndUserId]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveByStatus]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From MediaView
	Where [Status] = @Status AND UserId = @userId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByStatus].[@Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByStatus].[@userId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByStatus].[@Status]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByStatus].[@userId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="479" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrieveByStatus]&#xD;&#xA;(&#xD;&#xA;&#x9;@Status nvarchar(50),&#xD;&#xA;&#x9;@userId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveByTagIdAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT   * 
	From MediaView INNER JOIN
                      dbo.TagMedia ON MediaView.MediaId = dbo.TagMedia.MediaId INNER JOIN
                      dbo.Tag ON dbo.TagMedia.TagId = dbo.Tag.TagId
    Where dbo.TagMedia.TagId = @TagId AND MediaView.UserId = @UserId AND MediaView.Status = @Visiblity
    Order by TagName asc
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByTagIdAndUserId].[@TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByTagIdAndUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByTagIdAndUserId].[@Visiblity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByTagIdAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByTagIdAndUserId].[@TagId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByTagIdAndUserId].[@Visiblity]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="889" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Media_RetrieveByTagIdAndUserId]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@TagId int,&#xD;&#xA;&#x9;@Visiblity nvarchar(50) = 'Public'&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveByTagNameAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT   * 
	From MediaView INNER JOIN
                      dbo.TagMedia ON MediaView.MediaId = dbo.TagMedia.MediaId INNER JOIN
                      dbo.Tag ON dbo.TagMedia.TagId = dbo.Tag.TagId
    Where TagName = @TagName AND MediaView.UserId = @UserId
    Order by TagName asc
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByTagNameAndUserId].[@TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByTagNameAndUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByTagNameAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByTagNameAndUserId].[@TagName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="822" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Media_RetrieveByTagNameAndUserId]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@TagName nvarchar(100)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From MediaView 
	Where UserId = @UserId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="438" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrieveByUserId]&#xD;&#xA;( &#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrievePhotosThatDoNotIncludePhotosFromAlbumIdAndUserID]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--Select  MediaView.MediaId
	--From  
	--(
	--	Select AlbumMedia.MediaId, AlbumMedia.AlbumId From
	--	(	
	--	) D Inner Join AlbumMedia ON
	--	AlbumMedia.MediaId <> D.MediaId
	--) T  Inner Join MediaView ON
	--T.MediaID = MediaView.MediaId
	
	Select * From 
	(	
		Select AM.MediaId as AlbumMediaId
		From AlbumMedia AM Inner Join Album A
		ON AM.AlbumId = A.AlbumId
		Where A.UserId = @UserId AND A.AlbumId = @AlbumId
		Group By AM.MediaId	
	) AM right Join MediaView MV
	ON AM.AlbumMediaId = MV.MediaId 
	Where AlbumMediaId is Null AND MV.UserId = @UserId
	
	
	--Select AlbumMedia.MediaId, AlbumMedia.AlbumId From MediaView inner Join AlbumMedia On
	--		MediaView.MediaId <> AlbumMedia.MediaId
	--		Group By AlbumMedia.MediaId, AlbumMedia.AlbumId
	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrievePhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrievePhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrievePhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrievePhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="1216" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrievePhotosThatDoNotIncludePhotosFromAlbumIdAndUserID]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveRandom50Photos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(84) *
	From MediaView 
	Order by NEWID() asc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="427" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrieveRandom50Photos]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveRandom84PhotosByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(100) *
	From MediaView 
	Where UserId = @UserId
	Order by NEWID() asc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveRandom84PhotosByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveRandom84PhotosByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="479" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrieveRandom84PhotosByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveRandom90Photos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(90) *
	From MediaView 
	Where Status = 'public'
	Order by NEWID() asc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Status]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="453" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[Media_RetrieveRandom90Photos]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_RetrieveRandomByAlbumId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select Top(1) *
	From MediaView Inner Join AlbumMedia ON
	MediaView.MediaId = AlbumMedia.MediaId Inner Join Album ON
	Album.AlbumId = AlbumMedia.AlbumId	
	Where Album.AlbumId = @AlbumId AND MediaView.UserId = @UserId
	Order by NEWID() asc

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveRandomByAlbumId].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_RetrieveRandomByAlbumId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveRandomByAlbumId].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_RetrieveRandomByAlbumId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="652" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_RetrieveRandomByAlbumId]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_Search]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select * From MediaView
	Where Title LIKE '%' + @Search + '%' OR  [Description] LIKE '%' + @Search + '%' OR Tags LIKE '%' + @Search + '%'
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Search].[@Search]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Tags]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Search].[@Search]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="629" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Media_Search&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Search nvarchar(50)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_SearchByTextAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select * From MediaView
	Where UserId = @UserId AND (Title LIKE '%' + @Search + '%' OR  [Description] LIKE '%' + @Search + '%' OR Tags LIKE '%' + @Search + '%')
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchByTextAndUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchByTextAndUserId].[@Search]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Tags]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchByTextAndUserId].[@Search]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchByTextAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="690" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Media_SearchByTextAndUserId]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Search nvarchar(50),&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	
	Select * From 
	(	
		Select AM.MediaId as AlbumMediaId
		From AlbumMedia AM Inner Join Album A
		ON AM.AlbumId = A.AlbumId
		Where A.UserId = @UserId AND A.AlbumId = @AlbumId
		Group By AM.MediaId	
	) AM right Join MediaView MV
	ON AM.AlbumMediaId = MV.MediaId 
	Where AlbumMediaId is Null  AND  (@Search is Not Null AND Len(@Search) > 0) 
	AND MV.UserId = @UserId 
	AND (Title LIKE '%' + @Search + '%' OR  [Description] LIKE '%' + @Search + '%' OR Tags LIKE '%' + @Search + '%')
	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId].[@AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId].[@Search]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[Tags]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId].[@Search]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="954" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_SearchPhotosThatDoNotIncludePhotosByAlbumId]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Search nvarchar(150)&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	--Select * From 
	--(	
	--	Select AM.MediaId as AlbumMediaId
	--	From AlbumMedia AM Inner Join Album A
	--	ON AM.AlbumId = A.AlbumId
	--	Where A.UserId = @UserId AND A.AlbumId = @AlbumId
	--	Group By AM.MediaId	
	--) AM right Join MediaView MV
	--ON AM.AlbumMediaId = MV.MediaId 
	--Where AlbumMediaId is Null 
	--AND MV.UserId = @UserId 
	--AND ( Tags LIKE '%' + @Tag + '%')
	
	Select *
	From TagMedia TM
	Inner Join (
				Select TagId
				From Tag
				Inner Join @Tags NT
					On Tag.TagName = NT.Tag
	
				) T
		On TM.TagId = T.TagId
	Inner Join MediaView M
		ON TM.MediaId = M.MediaId
	Where M.UserId = @UserId
	AND M.MediaId Not IN
	(
		Select MediaId
		From AlbumMedia A
		Where A.AlbumId = @AlbumId
	)
	
	--Select  TM. 
	--From Tag 
	--Inner Join 
	--	(Select TagId, UserId, COUNT(TagId) as TagCount 
	--	 From TagMedia Inner Join Media On 
	--			TagMedia.MediaId = Media.MediaId
	--			Group By TagId, UserId
	--	) TM ON		
	--Tag.TagId = TM.TagId
	--Inner Join (
	--			 Select TagName, TagId 
	--			 From Tag T
	--			 Inner Join @Tags NT
	--				ON T.TagName = NT.Tag				 		
	--			) T
	--ON TM.TagId = T.TagId			 
	--Where UserId = @UserId 
	--Order by T.TagName asc
	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@Tags].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@AlbumId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@Tags]" Disambiguator="1">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@Tags].[Tag]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@AlbumId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID].[@Tags]">
						<Property Name="IsReadOnly" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References Name="[dbo].[Tags]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="1700" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_SearchTagsForPhotosThatDoNotIncludePhotosFromAlbumIdAndUserID]&#xD;&#xA;( &#xD;&#xA;&#x9;@AlbumId int,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Tags  Tags READONLY&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From MediaView

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="382" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_SelectAll]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From MediaView 
	Where MediaId = @MediaId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SelectByPrimaryKey].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SelectByPrimaryKey].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="443" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_SelectByPrimaryKey]&#xD;&#xA;( &#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_SelectByPrimaryKeyAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From MediaView 
	Where MediaId = @MediaId AND UserId = @UserId

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SelectByPrimaryKeyAndUserId].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_SelectByPrimaryKeyAndUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SelectByPrimaryKeyAndUserId].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_SelectByPrimaryKeyAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="487" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[Media_SelectByPrimaryKeyAndUserId]&#xD;&#xA;( &#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update Media 
	SET 	
	UserId = @UserId,
	Status = @Status 
	Where MediaId = @MediaId  AND UserId = @UserId
	
	Insert Into MediaLedger(Title, Description, Tags, MediaYear, MediaMonth, MediaDay, MediaId, UserId)
	Values (@Title, @Description, @Tags, @MediaYear, @MediaMonth, @MediaDay, @MediaId, @UserId)

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_Update].[@MediaDay]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@Title]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@Description]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="550" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@MediaYear]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@MediaMonth]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@MediaDay]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@Status]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@Tags]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_Update].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="899" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[Media_Update]&#xD;&#xA;( &#xD;&#xA;&#x9;@Title nvarchar(100),&#xD;&#xA;&#x9;@Description nvarchar(550),&#xD;&#xA;&#x9;--@TimesViewed int,&#xD;&#xA;&#x9;@MediaYear int = null,&#xD;&#xA;&#x9;@MediaMonth int = null,&#xD;&#xA;&#x9;@MediaDay int = null,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Status nvarchar(50),&#xD;&#xA;&#x9;@Tags nvarchar(250),&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Media_UpdateStatus]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update Media 
	SET 	
	Status = @Status 
	Where MediaId = @MediaId  AND UserId = @UserId


END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_UpdateStatus].[@Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_UpdateStatus].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media_UpdateStatus].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_UpdateStatus].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_UpdateStatus].[@Status]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Media_UpdateStatus].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="514" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[Media_UpdateStatus]&#xD;&#xA;( &#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Status nvarchar(50),&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[MediaFile]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaFile].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaFile].[FileId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaFile].[MediaFormat]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaFile].[MediaType]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[MediaLedger]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[MediaLedgerId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[Title]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[Description]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="2000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[Tags]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[MediaYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[MediaMonth]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[MediaDay]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[InsertDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaLedger].[LocationId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[MediaQueue]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue].[MediaQueueId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue].[MediaBytes]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue].[Filename]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaQueue_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Delete From MediaQueue 
	Where MediaQueue.MediaId = @MediaId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaQueue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_Delete].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaQueue_Delete].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="549" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE MediaQueue_Delete&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaQueue_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Insert INTO MediaQueue(MediaId, MediaBytes, [Filename])VALUES(@MediaId, @MediaBytes, @Filename)
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaQueue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[MediaBytes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[Filename]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_Insert].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_Insert].[@MediaBytes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_Insert].[@Filename]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaQueue_Insert].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaQueue_Insert].[@MediaBytes]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaQueue_Insert].[@Filename]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="649" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[MediaQueue_Insert] &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@MediaBytes varbinary(max),&#xD;&#xA;&#x9;@Filename nvarchar(250)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaQueue_InsertExif]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	Insert Into Exif(MediaId, [Key], Value)
	Select MediaId, [Key], Value
	From @ExifCollection	

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Exif]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Exif].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Exif].[Key]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Exif].[Value]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection].[Key]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection].[Value]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection]" Disambiguator="5">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection].[MediaId]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection].[Key]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection].[Value]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="250" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaQueue_InsertExif].[@ExifCollection]">
						<Property Name="IsReadOnly" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References Name="[dbo].[ExifCollection]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="569" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE MediaQueue_InsertExif&#xD;&#xA;(&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;&#x9;@ExifCollection ExifCollection readonly&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaQueue_RetrieveByMediaId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select MediaId, MediaQueueId, MediaBytes, [Filename]
	From MediaQueue
	Where MediaId = @MediaId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaQueue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[MediaQueueId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[MediaBytes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue].[Filename]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaQueue_RetrieveByMediaId].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaQueue_RetrieveByMediaId].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="551" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[MediaQueue_RetrieveByMediaId] &#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[MediaUploadBatch]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaUploadBatch].[UploadBatch]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaUploadBatch].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaUploadBatch].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaUploadBatch_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Insert Into MediaUploadBatch (MediaId, UploadBatch) Values(@MediaId, @BatchId)
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaUploadBatch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch].[UploadBatch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch_Insert].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch_Insert].[@BatchId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaUploadBatch_Insert].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaUploadBatch_Insert].[@BatchId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="609" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[MediaUploadBatch_Insert]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@BatchId uniqueidentifier&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaUploadBatch_RetrieveMediaByBatchId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select * 
	From MediaUploadBatch MB Inner join MediaViewAll MV
	ON  MB.MediaId = MV.MediaId
	Where MB.UploadBatch = @BatchId
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaUploadBatch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewAll]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewAll].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch].[UploadBatch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaUploadBatch_RetrieveMediaByBatchId].[@BatchId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaUploadBatch_RetrieveMediaByBatchId].[@BatchId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="607" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[MediaUploadBatch_RetrieveMediaByBatchId]&#xD;&#xA;(&#xD;&#xA;&#x9;@BatchId uniqueidentifier&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[MediaView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     dbo.Media.Status, dbo.Media.CreateDate, dbo.Media.UserId, dbo.Media.MediaId, dbo.[User].FirstName, dbo.[User].AccountStatus, dbo.[User].LastName, 
                      dbo.[User].Deleted, dbo.[User].Password, dbo.[User].Email, dbo.[User].DisplayName, dbo.[User].Username,  
                      dbo.[User].EnableReceivingOfEmails, dbo.[User].WebViewMaxWidth, dbo.[User].WebViewMaxHeight, L.Title, L.Description,  
                      SUBSTRING(
						(SELECT ', ' + T.TagName
						FROM Tag T
						Inner Join TagMedia TM
							On T.TagId = TM.TagId
						Where TM.MediaId = L.MediaId
						ORDER BY T.TagName
						FOR XML PATH('')),2,200000) as Tags, 
						L.MediaDay, L.MediaYear, L.MediaMonth,
                          (SELECT     COUNT(*) AS CommentCount
                            FROM          Comment
                            WHERE      Comment.MediaId = dbo.Media.MediaId) AS CommentCount
FROM         dbo.Media INNER JOIN
                      dbo.[User] ON dbo.Media.UserId = dbo.[User].UserId INNER JOIN
                          (SELECT     MediaId, Title, Description, Tags, MediaDay, MediaYear, MediaMonth
                            FROM          (SELECT     MediaId, InsertDate, Title, Description, Tags, MediaDay, MediaYear, MediaMonth, row_number() OVER (partition BY MEdiaID
                                                    ORDER BY InsertDate DESC) AS rn
                            FROM          dbo.MediaLedger) AS T
WHERE     rn = 1) AS L ON Media.MediaId = L.MediaId
WHERE     dbo.Media.UploadStatus = 'Completed']]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Status]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[Status]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[CreateDate]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[CreateDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[MediaId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[FirstName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[FirstName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[AccountStatus]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[AccountStatus]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[LastName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[LastName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Deleted]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Deleted]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Password]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Password]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Email]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Email]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[DisplayName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[DisplayName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Username]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Username]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[EnableReceivingOfEmails]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[WebViewMaxWidth]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[WebViewMaxWidth]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[WebViewMaxHeight]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[WebViewMaxHeight]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Title]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Title]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Description]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Description]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[Tags]" />
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[MediaDay]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaDay]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[MediaYear]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaYear]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[MediaMonth]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaMonth]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaView].[CommentCount]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxWidth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxHeight]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UploadStatus]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1616" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.MediaView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[MediaViewAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     dbo.Media.Status, dbo.Media.CreateDate, dbo.Media.UserId, dbo.Media.MediaId, dbo.[User].FirstName, dbo.[User].AccountStatus, dbo.[User].LastName, 
                      dbo.[User].Deleted, dbo.[User].Password, dbo.[User].Email, dbo.[User].DisplayName, dbo.[User].Username, 
                      dbo.[User].EnableReceivingOfEmails, L.Title, L.Description, SUBSTRING(
						(SELECT ', ' + T.TagName
						FROM Tag T
						Inner Join TagMedia TM
							On T.TagId = TM.TagId
						Where TM.MediaId = L.MediaId
						ORDER BY T.TagName
						FOR XML PATH('')),2,200000) as Tags,  L.MediaDay, L.MediaYear, L.MediaMonth,
                          (SELECT     COUNT(*) AS CommentCount
                            FROM          Comment
                            WHERE      Comment.MediaId = dbo.Media.MediaId) AS CommentCount
FROM         dbo.Media INNER JOIN
                      dbo.[User] ON dbo.Media.UserId = dbo.[User].UserId INNER JOIN
                          (SELECT     MediaId, Title, Description, Tags, MediaDay, MediaYear, MediaMonth
                            FROM          (SELECT     MediaId, InsertDate, Title, Description, Tags, MediaDay, MediaYear, MediaMonth, row_number() OVER (partition BY MEdiaID
                                                    ORDER BY InsertDate DESC) AS rn
                            FROM          dbo.MediaLedger) AS T
WHERE     rn = 1) AS L ON Media.MediaId = L.MediaId]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Status]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[Status]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[CreateDate]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[CreateDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[MediaId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Media].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[FirstName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[FirstName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[AccountStatus]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[AccountStatus]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[LastName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[LastName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Deleted]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Deleted]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Password]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Password]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Email]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Email]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[DisplayName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[DisplayName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Username]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Username]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[EnableReceivingOfEmails]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Title]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Title]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Description]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[Description]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[Tags]" />
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[MediaDay]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaDay]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[MediaYear]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaYear]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[MediaMonth]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaMonth]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[MediaViewAll].[CommentCount]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1481" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.MediaViewAll&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[MediaViewed]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaViewed].[MediaViewedId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaViewed].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaViewed].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaViewed].[LastViewed]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaViewed].[ViewCount]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[MediaViewed].[FirstViewed]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[MediaViewed_IncrementMediaCount]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	IF Exists(
				Select * 
				From MediaViewed 
				Where MediaId = @MediaId AND UserId = @UserId
			  )
		BEGIN
		
			Update MediaViewed
			Set ViewCount = (ViewCount + 1),
			LastViewed = (getutcdate())
			Where MediaId = @MediaId AND UserId = @UserId
		
		END
	ELSE
		BEGIN
			Insert Into MediaViewed(MediaId, UserId) Values (@MediaId, @UserId)
		END
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaViewed]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed_IncrementMediaCount].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed_IncrementMediaCount].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[ViewCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[LastViewed]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaViewed_IncrementMediaCount].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[MediaViewed_IncrementMediaCount].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="846" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[MediaViewed_IncrementMediaCount]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Paging_RetrieveNextPreviousMedia]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	Declare @Current int
	Declare @Next int
	Declare @Previous int

   	DECLARE @NextPrevious TABLE
	(
	  NextId int,
	  PreviousId int
	)
	
	Declare @Media Table
	(
	  MediaId int,
	  RowNumber int,
	  CreateDate datetime2
	)
    
    ;WITH MediaRow AS
	( 
		SELECT MediaId, UserId, CreateDate,
		ROW_NUMBER() OVER (ORDER BY CreateDate desc) AS RowNumber
		FROM Media 
		Where UserId = 9 And Status = 'Public'
	)

	Insert INTO @Media(MediaId,RowNumber, CreateDate)
	Select MediaId, RowNumber, CreateDate
	From MediaRow
	
	
	Set @Current = (Select RowNumber From @Media Where MediaId = @MediaId)
	Set @Next = (Select MediaId From @Media Where RowNumber = (@Current - 1)  )
	Set @Previous = (Select MediaId From @Media Where RowNumber = (@Current + 1) )
	
	Insert INTO @NextPrevious(NextId, PreviousId)VALUES(IsNull(@Next, -1), IsNull(@Previous, -1))	
	
	Select * From @NextPrevious
    
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[RowNumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[RowNumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@NextPrevious].[NextId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@NextPrevious].[PreviousId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@NextPrevious]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@NextPrevious].[NextId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@NextPrevious].[PreviousId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[MediaId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[RowNumber]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@Media].[CreateDate]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Precision" Value="7" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[datetime2]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[CTE1].[MediaRow]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[CTE1].[MediaRow].[MediaId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[MediaId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[CTE1].[MediaRow].[UserId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[UserId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[CTE1].[MediaRow].[CreateDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[CreateDate]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[CTE1].[MediaRow].[RowNumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrieveNextPreviousMedia].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1404" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Paging_RetrieveNextPreviousMedia]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Paging_RetrievePagingByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
		Declare @Paging Table  (PageIndex VarChar(3), PageText VarChar(3)) 	

	Begin
			Declare @StartIndex Int, @EndIndex Int, @Incr Int  
		
			Set @StartIndex = 0 
			Set @EndIndex = 0
			Set @Incr = 0  
			Select @StartIndex = Ascii('A')  
			Select @EndIndex = Ascii('Z')  
			Select @Incr = @StartIndex  
			While (@EndIndex >= @Incr )  
			Begin  
				Insert Into @Paging  
				Select Char(@Incr), Char(@Incr)  
				Select @Incr = @Incr+1  
			End  
	End

	Select [@Paging].PageIndex, COALESCE(MediaCountInLetter, 0) as MediaCountInLetter
	From
	(
		Select PageText, COUNT(PageIndex)AS MediaCountInLetter 
		From (
		   Select TagId, TagName, Tags.MediaId, Media.UserId
		   From
		   (			Select TagMedia.TagId, TagName, TagMedia.MediaId
						From Tag inner join TagMedia 
						ON Tag.TagId = TagMedia.TagId 
		   ) as Tags Inner Join Media 
		   ON Tags.MediaId = Media.MediaId
		   Where UserId = @UserId
	) as TagsAndMedia Left Join @Paging ON Upper(Left(TagName,1)) = PageText
	Group by PageText) As LetterCounts Right Join @Paging 
	On LetterCounts.PageText = [@Paging].PageIndex
	END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging].[PageText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging].[PageIndex]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging].[PageText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging].[PageIndex]" />
				</Entry>
				<Entry />
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging].[PageIndex]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="3" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrievePagingByUserId].[@Paging].[PageText]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="3" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1574" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Paging_RetrievePagingByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	

    -- Insert statements for procedure here
		Declare @Paging Table  (PageIndex VarChar(3), PageText VarChar(3))		
		Insert Into @Paging( PageIndex, PageText)Values(@Letter,@Letter)
		
		--Minus 1 from the current page. There is no page 0, the code however is based on a zero based index.
		Declare @Head int = @PageSize * (@CurrentPage - 1)
		Declare @Tail int = @Head + @PageSize

		Select * From
		( Select ROW_NUMBER() Over (Order By TagName) AS rownum, TagId, TagName, [Description], PageText, 0 as TagCount
			From (
		   Select TagId, TagName, PageText, [Description]
				From (
				   Select TagId, TagName, Tags.MediaId, [Description], Media.UserId
				   From
				   (			Select TagMedia.TagId, TagName, [Description], TagMedia.MediaId
								From Tag inner join TagMedia 
								ON Tag.TagId = TagMedia.TagId 
				   ) as Tags Inner Join Media 
				   ON Tags.MediaId = Media.MediaId
				   Where UserId = @UserId
			) as TagsAndMedia inner Join @Paging ON Upper(Left(TagName,1)) = PageText
			--Where PageText <> Null
			Group by PageText, TagName, TagId, [Description]
			) as FilteredTags) RowFilter
		Where RowFilter.rownum > @Head AND RowFilter.rownum <= @Tail
	END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging].[PageIndex]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging].[PageText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Letter]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging].[PageText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging].[PageText]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging].[PageIndex]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="3" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Paging].[PageText]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="3" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@Letter]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@PageSize]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingByUserIdAndLetter].[@CurrentPage]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1675" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Paging_RetrievePagingByUserIdAndLetter]&#xD;&#xA;(&#xD;&#xA;&#x9;@Letter char,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@PageSize int,&#xD;&#xA;&#x9;@CurrentPage int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
  --Declare @Letter char
  --Declare @UserId int
  --Declare @PageSize int
  --Declare @CurrentPage int
  
  --set @Letter = 'J'
  --set @UserId = 9
  --set @PageSize = 5
  --set @CurrentPage = 1

    -- Insert statements for procedure here
		Declare @Paging Table  (PageIndex VarChar(3), PageText VarChar(3))		
		Insert Into @Paging( PageIndex, PageText)Values(@Letter,@Letter)
		
		--Minus 1 from the current page. There is no page 0, the code however is based on a zero based index.
		--Declare @Head int = @PageSize * (@CurrentPage - 1)
		--Declare @Tail int = @Head + @PageSize

		Select Count(PageText) as TagCount From
		( Select ROW_NUMBER() Over (Order By TagName) AS rownum, TagId, TagName, PageText, 0 as TagCount
			From (
		   Select TagId, TagName, PageText
				From (
				   Select TagId, TagName, Tags.MediaId, Media.UserId
				   From
				   (			Select TagMedia.TagId, TagName, TagMedia.MediaId
								From Tag inner join TagMedia 
								ON Tag.TagId = TagMedia.TagId 
				   ) as Tags Inner Join Media 
				   ON Tags.MediaId = Media.MediaId
				   Where UserId = @UserId
			) as TagsAndMedia inner Join @Paging ON Upper(Left(TagName,1)) = PageText
			--Where PageText <> Null
			Group by PageText, TagName, TagId
			) as FilteredTags) RowFilter
			group by PageText
	END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging].[PageIndex]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging].[PageText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Letter]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging].[PageText]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging].[PageText]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging].[PageIndex]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="3" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Paging].[PageText]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="3" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@Letter]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Paging_RetrievePagingCountByUserIdAndLetter].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1761" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Paging_RetrievePagingCountByUserIdAndLetter]&#xD;&#xA;(&#xD;&#xA;&#x9;@Letter char,&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Album]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Album].[AlbumId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_AlbumMedia_1]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[AlbumMedia].[AlbumId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[AlbumMedia].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Batch]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[UploadBatch].[BatchId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[UploadBatch]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Comment]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Comment].[CommentId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Exif_1]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Exif].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Exif].[Key]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Exif]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_File]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[File].[FileId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[File]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Location]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Location].[LocationId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Location]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_MediaLedger]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MediaLedger].[MediaLedgerId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_MediaQueue]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MediaQueue].[MediaQueueId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaQueue]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_MediaUploadBatch]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MediaUploadBatch].[UploadBatch]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MediaUploadBatch].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaUploadBatch]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Photo]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Media].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_PhotoFile]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MediaFile].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MediaFile].[FileId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MediaFile]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_RecentActivity]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[RecentActivity].[RecentActivityId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[RecentActivity]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Tag]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Tag].[TagId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_TagPhoto]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TagMedia].[TagId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TagMedia].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_User]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[User].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100PrimaryKeyConstraint" Name="[dbo].[PK_Viewed]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Viewed].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Viewed].[MediaId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Viewed]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Recent_GetTimelineForUser]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select E.*, M.CreateDate, M.Status, M.UploadStatus, M.UserId
Into #MediaWithYear 
From (Select	MediaId,
			Title,
			Description,
			Tags, 
			MediaDay, 
			MediaYear, 
			MediaMonth
			
	FROM          
			(SELECT MediaId, 
					InsertDate, 
					Title, 
					Description, 
					Tags, 
					MediaDay, 
					MediaYear,
					MediaMonth, 
					row_number() OVER	(
											partition BY MEdiaID 
											ORDER BY InsertDate DESC			
										) AS rn
					FROM dbo.MediaLedger
		    ) AS T
	WHERE rn = 1) E 
	Inner Join Media M
		ON E.MediaId = M.MediaId
	Where E.MediaYear is Not Null and M.UserId = 9
	
	Select MediaYear, COUNT(MediaYear) as count
	From #MediaWithYear
	group by MediaYear
	Order By MediaYear
	
	Drop table #MediaWithYear
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UploadStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[MediaYear]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[MediaId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[Title]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[Title]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[Description]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[Description]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[Tags]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[Tags]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[MediaDay]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaDay]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[MediaYear]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaYear]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[MediaMonth]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaMonth]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[CreateDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[CreateDate]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[Status]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[Status]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[UploadStatus]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[UploadStatus]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetTimelineForUser].[#MediaWithYear].[UserId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[UserId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_GetTimelineForUser].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1269" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Recent_GetTimelineForUser&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Recent_GetYearByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select M.*
	From (Select	MediaId,
			Title,
			Description,
			Tags, 
			MediaDay, 
			MediaYear, 
			MediaMonth
			
	FROM          
			(SELECT MediaId, 
					InsertDate, 
					Title, 
					Description, 
					Tags, 
					MediaDay, 
					MediaYear,
					MediaMonth, 
					row_number() OVER	(
											partition BY MEdiaID 
											ORDER BY InsertDate DESC			
										) AS rn
					FROM dbo.MediaLedger
		    ) AS T
	WHERE rn = 1) E 
	Inner Join MediaView M
		ON E.MediaId = M.MediaId
	Where E.MediaYear = @Year AND M.UserId = @UserId
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetYearByUserId].[@Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetYearByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_GetYearByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_GetYearByUserId].[@Year]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1073" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Recent_GetYearByUserId&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Year int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Recent_GetYearsForUser]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select E.*, M.CreateDate, M.Status, M.UploadStatus, M.UserId
Into #MediaWithYear 
From (Select	MediaId,
			Title,
			Description,
			Tags, 
			MediaDay, 
			MediaYear, 
			MediaMonth
			
	FROM          
			(SELECT MediaId, 
					InsertDate, 
					Title, 
					Description, 
					Tags, 
					MediaDay, 
					MediaYear,
					MediaMonth, 
					row_number() OVER	(
											partition BY MEdiaID 
											ORDER BY InsertDate DESC			
										) AS rn
					FROM dbo.MediaLedger
		    ) AS T
	WHERE rn = 1) E 
	Inner Join Media M
		ON E.MediaId = M.MediaId
	Where E.MediaYear is Not Null and M.UserId = @UserId
	
	Select MediaYear, COUNT(MediaYear) as count
	From #MediaWithYear
	group by MediaYear
	Order By MediaYear
	
	Drop table #MediaWithYear
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UploadStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetYearsForUser].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[MediaYear]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[MediaId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[Title]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[Title]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[Description]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[Description]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[Tags]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[Tags]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[MediaDay]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaDay]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[MediaYear]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaYear]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[MediaMonth]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaLedger].[MediaMonth]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[CreateDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[CreateDate]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[Status]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[Status]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[UploadStatus]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[UploadStatus]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Recent_GetYearsForUser].[#MediaWithYear].[UserId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Media].[UserId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_GetYearsForUser].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1280" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Recent_GetYearsForUser]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Recent_Uploads]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	Create TABLE #TopResults 
	(
		  MediaId int,
		  CreateDate datetime
	)
	
	Create TABLE #RecentUploads 
	(
		  MediaId int,
		  Age nvarchar(100)
	)
	
    -- Insert statements for procedure here
	Declare @Sql nvarchar(200); 
	set @Sql = 'Select top(' + Cast(@photoCount as nvarchar) + ') MediaId, CreateDate 
				From MediaView
				Where UserId = ' + CAST(@UserId as nvarchar) + ' AND [Status] = ''' + @Status + '''
				Order by CreateDate desc'
	
	Insert into #TopResults (MediaId, CreateDate)
	EXEC SP_EXECUTESQL @Sql		
		
	-- Day 1
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'DayOne' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(HOUR , -24, GETUTCDATE() )
	
	-- Day 2
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'DayTwo' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(HOUR , -72, GETUTCDATE())
	AND CreateDate < DATEADD(HOUR , -24, GETUTCDATE())
	
	-- Week 1
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'WeekOne' as Age 
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -14, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -3, GETUTCDATE())

	-- Week 2
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'WeekTwo' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -21, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -14, GETUTCDATE())
	
	-- Week 3
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'WeekThree' as Age 
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -27, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -21, GETUTCDATE())
	
	-- Month 1
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'MonthOne' as Age 
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -59, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -27, GETUTCDATE())
	
	-- Month 2
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'MonthTwo' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -89, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -59, GETUTCDATE())
	
	-- Month 3
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'MonthThree' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -119, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -89, GETUTCDATE())
	
	-- Month 4
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'MonthFour' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -149, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -119, GETUTCDATE())
	
	-- Month 5
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'MonthFive' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -179, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -149, GETUTCDATE())
	
	-- Month 6
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'MonthSix' as Age
	From #TopResults T 
	Where CreateDate >= DATEADD(DAY , -209, GETUTCDATE())
	AND CreateDate < DATEADD(DAY , -179, GETUTCDATE())
	
	-- Older
	Insert INTO #RecentUploads(MediaId, Age)
	Select MediaId, 'Older' as Age
	From #TopResults T 
	Where CreateDate < DATEADD(DAY , -209, GETUTCDATE())

	Select M.*, U.Age 
	from #RecentUploads U
	Inner Join MediaView M
		On U.MediaId = M.MediaId
	
		
	Drop Table #RecentUploads
	Drop Table #TopResults 
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[@photoCount]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[@Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#TopResults]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#TopResults].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#TopResults].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#RecentUploads]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#RecentUploads].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#RecentUploads].[Age]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#RecentUploads].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Recent_Uploads].[#RecentUploads].[Age]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Recent_Uploads].[#TopResults]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Recent_Uploads].[#TopResults].[MediaId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Recent_Uploads].[#TopResults].[CreateDate]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[datetime]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Recent_Uploads].[#RecentUploads]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Recent_Uploads].[#RecentUploads].[MediaId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Recent_Uploads].[#RecentUploads].[Age]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="100" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_Uploads].[@photoCount]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_Uploads].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Recent_Uploads].[@Status]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="3788" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  Recent_Uploads&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@photoCount int,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Status nvarchar(20) = 'Public'&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[RecentActivity]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[RecentActivity].[RecentActivityId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[RecentActivity].[ActivityType]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[RecentActivity].[ActivityCount]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[RecentActivity].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[RecentActivity].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[RecentActivity_OneHourActivityRollUp]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	--DECLARE @ActivityTable TABLE
	--(
	--  ActivityType nvarchar(50),
	--  ActivityCount int
	--)
	
	--Photos added
	Insert Into RecentActivity(ActivityType, ActivityCount, UserId)
	Select 'PhotosAdded' as ActivityType, COUNT(*) as ActivityCount, UserId From Media Where CreateDate > DATEADD(HOUR , -1, GETUTCDATE() ) Group By UserId 
	
	--Friends
	Insert Into RecentActivity(ActivityType, ActivityCount, UserId)
	Select 'FriendsAdded' as ActivityType, COUNT(*) as ActivityCount, UserId From Friend Where CreateDate > DATEADD(HOUR , -1, GETUTCDATE() ) Group By UserId
	
	--Albums
	Insert Into RecentActivity(ActivityType, ActivityCount, UserId)
	Select 'NewAlbums' as ActivityType, COUNT(*) as ActivityCount, UserId From Album Where CreateDate > DATEADD(HOUR , -1, GETUTCDATE() ) Group By UserId
	
	--Comments
	Insert Into RecentActivity(ActivityType, ActivityCount, UserId)
	Select 'NewComments' as ActivityType, COUNT(*) as ActivityCount, UserId 
	From Comment C 
	Where CommentDate > DATEADD(HOUR , -1, GETUTCDATE())
	Group By UserId
	
	-- Album Meida
	Insert Into RecentActivity(ActivityType, ActivityCount, UserId)
	Select 'AddedPhotosToAlbums' as ActivityType, COUNT(*) as ActivityCount, UserId From AlbumMedia AM inner join Album A On A.AlbumId = AM.AlbumId 
	Where  AM.CreateDate > DATEADD(HOUR , -1, GETUTCDATE()) Group By UserId
	
	-- Tags Added
	Insert Into RecentActivity(ActivityType, ActivityCount, UserId)
	Select 'TagsAddedToPhotos' as ActivityType, COUNT(*) as ActivityCount, UserId 
	From TagMedia TM inner join Media M On TM.MediaId = M.MediaId 
	Where  TM.CreateDate > DATEADD(HOUR , -1, GETUTCDATE()) Group By UserId

    
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[RecentActivity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[ActivityType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[ActivityCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Comment].[CommentDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[AlbumId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AlbumMedia].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[CreateDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="2072" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[RecentActivity_OneHourActivityRollUp]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[RecentActivity_RetrieveFriendsActivityFromLastWeekByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--Select * 
	--	From RecentActivity RA Inner Join FriendView FV
	--On  RA.UserId = FV.UserId
	--Where FV.UserId = 9 AND CreateDate > DATEADD(DAY , -7, GETUTCDATE())


    -- Insert statements for procedure here
	Select ActivityType, SUM(ActivityCount) as ActivityCount , FriendId
	From RecentActivity RA Inner Join FriendView FV
	On  RA.UserId = FV.UserId
	Where FV.UserId = @UserId AND CreateDate > DATEADD(DAY , -7, GETUTCDATE())
	Group By  ActivityType, FriendId
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[RecentActivity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FriendView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FriendView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[ActivityType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[ActivityCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FriendView].[FriendId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity_RetrieveFriendsActivityFromLastWeekByUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[CreateDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[RecentActivity_RetrieveFriendsActivityFromLastWeekByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="974" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[RecentActivity_RetrieveFriendsActivityFromLastWeekByUserId] &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[RecentActivity_RetrieveOneMonthActivityRollUp]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	--DECLARE @ActivityTable TABLE
	--(
	--  ActivityType nvarchar(50),
	--  ActivityCount int
	--)
	
	----Photos added
	--Insert Into @ActivityTable(ActivityType, ActivityCount)
	--Select 'PhotosAdded' as ActivityType, COUNT(*) as ActivityCount From Media Where UserId = @UserId AND CreateDate > DATEADD(DAY , -30, GETUTCDATE() ) 
	
	----Friends
	--Insert Into @ActivityTable(ActivityType, ActivityCount)
	--Select 'FriendsAdded' as ActivityType, COUNT(*) as ActivityCount From Friend Where UserId = @UserId AND CreateDate > DATEADD(DAY , -30, GETUTCDATE() ) 
	
	----Albums
	--Insert Into @ActivityTable(ActivityType, ActivityCount)
	--Select 'NewAlbums' as ActivityType, COUNT(*) as ActivityCount From Album Where UserId = @UserId AND CreateDate > DATEADD(DAY , -30, GETUTCDATE() ) 
	
	----Comments
	--Insert Into @ActivityTable(ActivityType, ActivityCount)
	--Select 'NewComments' as ActivityType, COUNT(*) as ActivityCount 
	--From Comment C 
	--Where UserId = @UserId AND 
	--CommentDate > DATEADD(DAY , -30, GETUTCDATE())
	
	---- Album Meida
	--Insert Into @ActivityTable(ActivityType, ActivityCount)
	--Select 'AddedPhotosToAlbums' as ActivityType, COUNT(*) as ActivityCount From AlbumMedia AM inner join Album A On A.AlbumId = AM.AlbumId Where A.UserId = @UserId AND AM.CreateDate > DATEADD(DAY , -30, GETUTCDATE()) 
	
	---- Tags Added
	--Insert Into @ActivityTable(ActivityType, ActivityCount)
	--Select 'TagsAddedToPhotos' as ActivityType, COUNT(*) as ActivityCount From TagMedia TM inner join Media M On TM.MediaId = M.MediaId Where M.UserId = @UserId AND TM.CreateDate > DATEADD(DAY , -30, GETUTCDATE()) 
	
	Select ActivityType, Sum(ActivityCount) as 'ActivityCount', UserId
	From RecentActivity	
	Where UserId = @UserId AND CreateDate > DATEADD(DAY , -30, GETUTCDATE())
	Group By UserId, ActivityType 


    
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[RecentActivity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[ActivityType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[ActivityCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity_RetrieveOneMonthActivityRollUp].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RecentActivity].[CreateDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[RecentActivity_RetrieveOneMonthActivityRollUp].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="2278" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[RecentActivity_RetrieveOneMonthActivityRollUp]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Reporting_SiteStatistics]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	DECLARE @Statistics TABLE
	(
	  Name nvarchar(50),
	  [Count] int
	)
	
	--Friends
	Insert INTO @Statistics([Count], Name)
	Select COUNT(*) as [Count], 'Friends' as Name
	From Friend
	Where UserId = @UserId
	
	--Media/Photos
	Insert INTO @Statistics([Count], Name)
	Select COUNT(*) as [Count], 'Photos' as Name
	From Media
	Where UserId = @UserId
	
	--Albums
	Insert INTO @Statistics([Count], Name)
	Select COUNT(*) as [Count], 'Albums' as Name
	From Album
	Where UserId = @UserId
	
	--Tags
	Insert INTO @Statistics([Count], Name)
	Select COUNT(*) as [Count], 'Tags' as Name
	From 
	(
		Select COUNT(*) AS TagCount From Tag T Inner join TagMedia TM
		ON T.TagId = TM.TagId Inner Join Media M
		ON TM.MediaId = M.MediaId
		Where UserId = 9
		Group By TM.TagId
	) C
	
	
	
	Select Name, [Count]
	From @Statistics
	ORder By Name
	
	 
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Reporting_SiteStatistics].[@Statistics].[Count]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reporting_SiteStatistics].[@Statistics].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Friend].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reporting_SiteStatistics].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Album].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Reporting_SiteStatistics].[@Statistics]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Reporting_SiteStatistics].[@Statistics].[Name]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[Reporting_SiteStatistics].[@Statistics].[Count]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Reporting_SiteStatistics].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1333" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Reporting_SiteStatistics] &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Reporting_Top10MostViewed]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select Top 5 * 
	From MediaViewed MV Inner Join MediaView M
	ON MV.MediaId = M.MediaId
	Where M.UserId = @UserId
	Order By ViewCount DESC
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaViewed]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reporting_Top10MostViewed].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaViewed].[ViewCount]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Reporting_Top10MostViewed].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="636" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Reporting_Top10MostViewed&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Tag]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Tag].[TagId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Tag].[TagName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Tag].[Description]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_DeleteTagsByMediaId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Delete From TagMedia Where MediaId = @MediaId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_DeleteTagsByMediaId].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_DeleteTagsByMediaId].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="544" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Tag_DeleteTagsByMediaId&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;&#x9;(&#xD;&#xA;&#x9;&#x9;@MediaId int&#xD;&#xA;&#x9;)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_GetRelatedTags]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select T.*, 0 as TagCount 
	From (
		Select TM.TagId 
		From 
			(
				Select *
				From TagMedia
				Where TagId = @TagId
			) M
		Inner Join TagMedia TM
			ON M.MediaId = TM.MediaId
		Where TM.TagId <> @TagId
		Group by TM.TagId
	  ) R
	Inner Join Tag T
	ON R.TagId = T.TagId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_GetRelatedTags].[@TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_GetRelatedTags].[@TagId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="788" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Tag_GetRelatedTags] &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@TagId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_GetRelatedTagsByYear]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	
	Select M.MediaId
	Into #Year
	From (Select	MediaId,
			Title,
			Description,
			Tags, 
			MediaDay, 
			MediaYear, 
			MediaMonth
			
	FROM          
			(SELECT MediaId, 
					InsertDate, 
					Title, 
					Description, 
					Tags, 
					MediaDay, 
					MediaYear,
					MediaMonth, 
					row_number() OVER	(
											partition BY MEdiaID 
											ORDER BY InsertDate DESC			
										) AS rn
					FROM dbo.MediaLedger
		    ) AS T
	WHERE rn = 1) E 
	Inner Join MediaView M
		ON E.MediaId = M.MediaId
	Where E.MediaYear = @Year AND M.UserId = @UserId
	
		Select T.*, 0 as TagCount 
	From (
		Select TM.TagId 
		From #Year M
		Inner Join TagMedia TM
			ON M.MediaId = TM.MediaId
		Group by TM.TagId
	  ) R
	Inner Join Tag T
	ON R.TagId = T.TagId
	
	Drop Table #Year
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaLedger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[InsertDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaDay]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaMonth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaLedger].[MediaYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_GetRelatedTagsByYear].[@Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_GetRelatedTagsByYear].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_GetRelatedTagsByYear].[#Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_GetRelatedTagsByYear].[#Year].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[Tag_GetRelatedTagsByYear].[#Year]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql90ComputedColumn" Name="[dbo].[Tag_GetRelatedTagsByYear].[#Year].[MediaId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[MediaView].[MediaId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_GetRelatedTagsByYear].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_GetRelatedTagsByYear].[@Year]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1285" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Tag_GetRelatedTagsByYear]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Year int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_InsertTagWithMediaId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
Declare @TagId int
if EXISTS(SELECT TagName
			FROM dbo.Tag  
			WHERE  TagName = @TagName
		)
	Begin
		 Set @tagId = (
						SELECT TagId
						FROM dbo.Tag
						WHERE  TagName = @TagName
					   )
	   

		Insert Into TagMedia(TagID,MediaId) Values (@tagId, @MediaId)
	End
ELSE
	Begin
		Insert INTO Tag(TagName)Values(@TagName)
		Declare @newTagId int
		set @newTagId = (Select @@IDENTITY)

		Insert Into TagMedia(TagID,MediaId) Values (@newTagId, @MediaId)
	End
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_InsertTagWithMediaId].[@TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_InsertTagWithMediaId].[@mediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_InsertTagWithMediaId].[@TagName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_InsertTagWithMediaId].[@mediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="795" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Tag_InsertTagWithMediaId] &#xD;&#xA;(&#xD;&#xA;&#x9;@TagName nvarchar(100),&#xD;&#xA;&#x9;@mediaId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_RetrieveTagByNameAndUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--Declare @TagName nvarchar(100)
	--Declare @UserId int
	
	--set @TagName = 'erin-meraz'
	--set @UserId = 9

    -- Insert statements for procedure here
    
    Select R.TagId, TagName, [Description], 0 as TagCount 
    From (    
			Select T.TagId
			From Tag T inner join TagMedia TM
			ON T.TagId = TM.TagId Inner Join Media M
			ON TM.MediaId = M.MediaId
			Where T.TagName = @TagName AND M.UserId = @UserId
			Group By T.TagId
		) R inner join Tag T
	ON T.TagId = R.TagId
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagByNameAndUserId].[@TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagByNameAndUserId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagByNameAndUserId].[@TagName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagByNameAndUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="980" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Tag_RetrieveTagByNameAndUserId &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@TagName nvarchar(100),&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_RetrieveTagsByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--WITH tm (TagId, MediaId, UserId)
	--AS
	--(		

		
	--  Select * From(Select Tag.TagId From Tag Inner join TagMedia On
	--	Tag.TagId = TagMedia.TagId
	--	Group By Tag.TagId) T Inner Join On 
		
		
		
		
	-- select TagId, MediaId, UserId from(	
	--	 Select TagId, media.MediaId, UserId 
	--	 From TagMedia Inner Join  Media On
	--	 TagMedia.MediaId = Media.MediaId
	--	 Group By TagId, Media.MediaId, UserId)T
	--	 Group by TagId, MediaId, UserId
	--)


 --   -- Insert statements for procedure here
	--SELECT  Tag.TagId, TagName
	--FROM Tag Inner Join tm ON
	--Tag.TagId = tm.TagId 
	Select Tag.TagId, TagName, TagCount, [Description] From Tag Inner Join (Select TagId, UserId, COUNT(TagId) as TagCount From TagMedia Inner Join Media On 
	TagMedia.MediaId = Media.MediaId
	Where Media.Status = @Visibility
	Group By TagId, UserId) TM ON
	Tag.TagId = TM.TagId                
	Where UserId = @UserId
	Order by TagName asc
    
    	--Select tagId From Tag Group By TagId) T INNER JOIN
     --                 dbo.TagMedia ON T.TagId = dbo.TagMedia.TagId INNER JOIN
     --                 dbo.Media ON dbo.TagMedia.MediaId = dbo.Media.MediaId
     --      Group By dbo.TagMedia.TagId, T.TagId, dbo.Media.UserId ) G  
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagsByUserId].[@Visibility]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagsByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagsByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagsByUserId].[@Visibility]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1749" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Tag_RetrieveTagsByUserId]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Visibility nvarchar(50) = 'Public'&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--WITH tm (TagId, MediaId, UserId)
	--AS
	--(		

		
	--  Select * From(Select Tag.TagId From Tag Inner join TagMedia On
	--	Tag.TagId = TagMedia.TagId
	--	Group By Tag.TagId) T Inner Join On 
		
		
		
		
	-- select TagId, MediaId, UserId from(	
	--	 Select TagId, media.MediaId, UserId 
	--	 From TagMedia Inner Join  Media On
	--	 TagMedia.MediaId = Media.MediaId
	--	 Group By TagId, Media.MediaId, UserId)T
	--	 Group by TagId, MediaId, UserId
	--)


 --   -- Insert statements for procedure here
	--SELECT  Tag.TagId, TagName
	--FROM Tag Inner Join tm ON
	--Tag.TagId = tm.TagId 
	Select Tag.TagId, TagName, TagCount, [Description] From Tag Inner Join (Select TagId, UserId, COUNT(TagId) as TagCount From TagMedia Inner Join Media On 
	TagMedia.MediaId = Media.MediaId
	Where Media.Status = @Visibility
	Group By TagId, UserId) TM ON
	Tag.TagId = TM.TagId                
	Where UserId = @UserId AND Tag.TagId = @TagId
	Order by TagName asc
    
    	--Select tagId From Tag Group By TagId) T INNER JOIN
     --                 dbo.TagMedia ON T.TagId = dbo.TagMedia.TagId INNER JOIN
     --                 dbo.Media ON dbo.TagMedia.MediaId = dbo.Media.MediaId
     --      Group By dbo.TagMedia.TagId, T.TagId, dbo.Media.UserId ) G  
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId].[@Visibility]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId].[@TagId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId].[@TagId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_RetrieveTagsByUserIdAndTagId].[@Visibility]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1794" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Tag_RetrieveTagsByUserIdAndTagId]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@TagId int,&#xD;&#xA;&#x9;@Visibility nvarchar(50) = 'Public'&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_Search]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	--WITH tm (TagId, MediaId, UserId)
	--AS
	--(		

		
	--  Select * From(Select Tag.TagId From Tag Inner join TagMedia On
	--	Tag.TagId = TagMedia.TagId
	--	Group By Tag.TagId) T Inner Join On 
		
		
		
		
	-- select TagId, MediaId, UserId from(	
	--	 Select TagId, media.MediaId, UserId 
	--	 From TagMedia Inner Join  Media On
	--	 TagMedia.MediaId = Media.MediaId
	--	 Group By TagId, Media.MediaId, UserId)T
	--	 Group by TagId, MediaId, UserId
	--)


 --   -- Insert statements for procedure here
	--SELECT  Tag.TagId, TagName
	--FROM Tag Inner Join tm ON
	--Tag.TagId = tm.TagId 
	Select Top 10 Tag.TagId, TagName, TagCount, [Description]  From Tag Inner Join (Select TagId, UserId, COUNT(TagId) as TagCount From TagMedia Inner Join Media On 
	TagMedia.MediaId = Media.MediaId
	Group By TagId, UserId) TM ON
	Tag.TagId = TM.TagId                
	Where UserId = @UserId AND TagName Like '%'+ @SearchText + '%'
	Order by TagName asc
    
    	--Select tagId From Tag Group By TagId) T INNER JOIN
     --                 dbo.TagMedia ON T.TagId = dbo.TagMedia.TagId INNER JOIN
     --                 dbo.Media ON dbo.TagMedia.MediaId = dbo.Media.MediaId
     --      Group By dbo.TagMedia.TagId, T.TagId, dbo.Media.UserId ) G  
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_Search].[@UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_Search].[@SearchText]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_Search].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_Search].[@SearchText]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1738" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Tag_Search]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@SearchText nvarchar(50)&#x9;&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Tag_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
    Update Tag 
    Set [Description] = @Description,
    TagName = @TagName
    From Tag T inner join TagMedia TM
    ON T.TagId = TM.TagId Inner Join Media M
    ON TM.MediaId = M.MediaId
    Where T.TagId = @TagId AND M.UserId = @UserId
   
    
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Tag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TagMedia].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_Update].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_Update].[@TagName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag].[TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_Update].[@TagId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Tag_Update].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_Update].[@TagId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_Update].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_Update].[@Description]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Tag_Update].[@TagName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="816" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE [dbo].[Tag_Update]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@TagId int,&#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@Description nvarchar(500),&#xD;&#xA;&#x9;@TagName nvarchar(100)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[TagMedia]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[TagMedia].[TagId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[TagMedia].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[TagMedia].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100TableType" Name="[dbo].[Tags]">
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100TableTypeSimpleColumn" Name="[dbo].[Tags].[Tag]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Token]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Token].[Token]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Token].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Token].[IsValid]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[Token_RetreiveCount]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT COUNT(*) 
	From Token
	Where Token.Token = @Token AND Token.IsValid = 1
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Token]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Token].[Token]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Token_RetreiveCount].[@Token]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Token].[IsValid]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[Token_RetreiveCount].[@Token]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="578" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Token_RetreiveCount &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Token nvarchar(50)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[UploadBatch]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[BatchId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[LocationName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Latitude]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="12" />
									<Property Name="Precision" Value="18" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Longitude]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="12" />
									<Property Name="Precision" Value="18" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Zoom]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[MapTypeId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Year]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Month]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Day]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Albums]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[Tags]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[UploadBatch].[MediaStatus]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[UploadBatch_GetById]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select * 
	From UploadBatch
	Where UploadBatch.BatchId = @BatchId
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UploadBatch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[BatchId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_GetById].[@BatchId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_GetById].[@BatchId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="570" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE UploadBatch_GetById&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@BatchId uniqueidentifier&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[UploadBatch_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Insert into UploadBatch (LocationName, Latitude, Longitude, Zoom, 
	MapTypeId, BatchId, [Year], [Month], [Day], Albums, Tags, MediaStatus)
	Values (@LocationName, @Latitude, @Longitude, @Zoom, 
	@MapTypeId, @BatchId, @Year, @Month, @Day, @Albums, @Tags, @MediaStatus)
	
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UploadBatch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[LocationName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Latitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Longitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Zoom]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[MapTypeId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[BatchId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Month]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Day]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Albums]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch].[MediaStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@LocationName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Latitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Longitude]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Zoom]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@MapTypeId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@BatchId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Month]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Day]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Albums]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@Tags]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploadBatch_Insert].[@MediaStatus]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@LocationName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Latitude]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="12" />
									<Property Name="Precision" Value="18" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Longitude]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Scale" Value="12" />
									<Property Name="Precision" Value="18" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Zoom]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@MapTypeId]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@BatchId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Year]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Month]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Day]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Albums]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@Tags]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploadBatch_Insert].[@MediaStatus]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="1109" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[UploadBatch_Insert]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@LocationName nvarchar(100) = null,&#xD;&#xA;&#x9;@Latitude decimal(18, 12) = null,&#xD;&#xA;&#x9;@Longitude decimal(18, 12) = null,&#xD;&#xA;&#x9;@Zoom int = null,&#xD;&#xA;&#x9;@MapTypeId nvarchar(50) = null,&#xD;&#xA;&#x9;@BatchId uniqueidentifier,&#xD;&#xA;&#x9;@Year int = null,&#xD;&#xA;&#x9;@Month int = null,&#xD;&#xA;&#x9;@Day int = null,&#xD;&#xA;&#x9;@Albums nvarchar(150) = null,&#xD;&#xA;&#x9;@Tags nvarchar(500) = null,&#xD;&#xA;&#x9;@MediaStatus nvarchar(50) = null&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	DECLARE @QueuedMediaItems TABLE
	(
		MediaId int,
		UploadStatus nvarchar(50),
		UserId int
	)
	
	Insert Into @QueuedMediaItems(MediaId, UploadStatus, UserId)
	Select MediaId, UploadStatus, UserId From Media Where UploadStatus = 'Queued'
	
	Update Media
	Set UploadStatus = 'Pending'
	Where UploadStatus = 'Queued'
	
	Select MediaId, UploadStatus, UserId From @QueuedMediaItems


END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems].[UploadStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UploadStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="ISqlDynamicColumnSource" Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems].[MediaId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems].[UploadStatus]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[nvarchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="ISql100SimpleColumn" Name="[dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending].[@QueuedMediaItems].[UserId]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="ISql90TypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="786" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[UploaderMedia_SelectAllAndSetUploadStatusToPending]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[UploaderMedia_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select *
	From Media
	Where MediaId = @MediaId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploaderMedia_SelectByPrimaryKey].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploaderMedia_SelectByPrimaryKey].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="446" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[UploaderMedia_SelectByPrimaryKey]&#xD;&#xA;( &#xD;&#xA;&#x9;@MediaId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[UploaderMedia_UpdateStatus]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Update Media 
	Set [UploadStatus] = @Status
	Where MediaId = @MediaId
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UploadStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploaderMedia_UpdateStatus].[@Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UploaderMedia_UpdateStatus].[@MediaId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploaderMedia_UpdateStatus].[@MediaId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[UploaderMedia_UpdateStatus].[@Status]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="603" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[UploaderMedia_UpdateStatus]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@MediaId int,&#xD;&#xA;&#x9;@Status nvarchar(50)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[User]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[FirstName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[LastName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[Password]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[Email]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[DisplayName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[Deleted]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[Username]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[LastLogin]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[CurrentSession]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[AccountStatus]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[EnableReceivingOfEmails]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[WebViewMaxWidth]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[WebViewMaxHeight]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[User].[MaxInvitations]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Index" Name="[dbo].[User].[NC_User_Username]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="ISqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[User].[Username]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_CheckAvailability]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select COUNT(*) as [Count] 
	From [User]
	Where Username = @Username
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_CheckAvailability].[@Username]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_CheckAvailability].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="577" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE User_CheckAvailability&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@Username nvarchar(40)&#xD;&#xA;)&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_Delete]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Delete From [User]
	Where UserId = @UserId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Delete].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Delete].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="411" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  User_Delete&#xD;&#xA;( &#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	INSERT INTO [dbo].[User] (FirstName, LastName, Password, Email, CreateDate, DisplayName, Deleted, Username, CurrentSession, AccountStatus) 
	VALUES (@FirstName, @LastName, @Password, @Email, GETUTCDATE(), @DisplayName, @Deleted, @Username, GETUTCDATE(), @AccountStatus)
	
	set @Identity = (select @@IDENTITY)
	return @Identity

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[CurrentSession]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Insert].[@Identity]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@FirstName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@LastName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@DisplayName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@Deleted]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@AccountStatus]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['Public']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Insert].[@Identity]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="934" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[User_Insert]&#xD;&#xA;( &#xD;&#xA;&#x9;@FirstName nvarchar(100),&#xD;&#xA;&#x9;@LastName nvarchar(100),&#xD;&#xA;&#x9;@Password nvarchar(250),&#xD;&#xA;&#x9;@Email nvarchar(250),&#xD;&#xA;&#x9;@DisplayName nvarchar(100),&#xD;&#xA;&#x9;@Deleted bit,&#xD;&#xA;&#x9;@Username nvarchar(50),&#xD;&#xA;&#x9;@AccountStatus nvarchar(50) = 'Public',&#xD;&#xA;&#x9;@Identity int OUTPUT&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_RetrieveByUsername]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From UserView
	Where Username  = @Username

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UserView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserView].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_RetrieveByUsername].[@Username]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_RetrieveByUsername].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="451" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[User_RetrieveByUsername]&#xD;&#xA;( &#xD;&#xA;&#x9;@Username nvarchar(50)) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_RetrieveRandomPhotoByUserId]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	
	Select Top(1) * 
	From MediaView M
	Where M.UserId = @UserId
	Order By NEWID()

	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_RetrieveRandomPhotoByUserId].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_RetrieveRandomPhotoByUserId].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="479" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;Create PROCEDURE  [dbo].[User_RetrieveRandomPhotoByUserId]&#xD;&#xA;(&#xD;&#xA;&#x9;@UserId int&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_RetrieveUserAndMedia]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    Select * From MediaView inner join 
								(
									Select UserId, (Select Top(1) MediaId From Media Where Status = 'Public' AND UserId = M.UserId ORder By NewId()) as MediaId  From Media as M Group By UserId
								) E On MediaView.MediaId = E.MediaId 
    

	
	
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[MediaId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[Status]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Media].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MediaView].[MediaId]" />
				</Entry>
				<Entry />
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="642" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[User_RetrieveUserAndMedia]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_RetrieveUserByLoginCredentials]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Select * 
	From UserView
	Where Username = @Username AND [Password] = @Password
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UserView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserView].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_RetrieveUserByLoginCredentials].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserView].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_RetrieveUserByLoginCredentials].[@Password]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_RetrieveUserByLoginCredentials].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_RetrieveUserByLoginCredentials].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="626" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[User_RetrieveUserByLoginCredentials]&#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;&#x9;@Username nvarchar(50),&#xD;&#xA;&#x9;@Password nvarchar(250)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_SelectAll]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From UserView

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UserView]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="381" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[User_SelectAll]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_SelectByPrimaryKey]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Select * 
	From UserView
	Where UserId = @UserId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[UserView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserView].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_SelectByPrimaryKey].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_SelectByPrimaryKey].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="438" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[User_SelectByPrimaryKey]&#xD;&#xA;( &#xD;&#xA;&#x9;@UserId int&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[User_Update]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	Update [User]
	SET 
	FirstName = @FirstName,
	LastName = @LastName,
	[Password] = @Password,
	Email = @Email,
	DisplayName = @DisplayName,
	Deleted = @Deleted,
	Username = @Username,
	AccountStatus = @AccountStatus,
	EnableReceivingOfEmails = @EnableReceivingOfEmails,
	WebViewMaxHeight = @WebViewMaxHeight, 
	WebViewMaxWidth = @WebViewMaxWidth
	
 
	Where UserId = @UserId 

END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@EnableReceivingOfEmails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxHeight]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@WebViewMaxHeight]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxWidth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@WebViewMaxWidth]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User_Update].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@FirstName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@LastName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@DisplayName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@Deleted]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@AccountStatus]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@EnableReceivingOfEmails]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@WebViewMaxHeight]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[User_Update].[@WebViewMaxWidth]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="172" />
				<Property Name="Length" Value="1065" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Chucksoft CodeGen&#xD;&#xA;-- Create date: Friday, October 30, 2009&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE  [dbo].[User_Update]&#xD;&#xA;( &#xD;&#xA;&#x9;@UserId int,&#xD;&#xA;&#x9;@FirstName nvarchar(100),&#xD;&#xA;&#x9;@LastName nvarchar(100),&#xD;&#xA;&#x9;@Password nvarchar(250),&#xD;&#xA;&#x9;@Email nvarchar(250),&#xD;&#xA;&#x9;@DisplayName nvarchar(100),&#xD;&#xA;&#x9;@Deleted bit,&#xD;&#xA;&#x9;@Username nvarchar(50),&#xD;&#xA;&#x9;@AccountStatus nvarchar(50),&#xD;&#xA;&#x9;@EnableReceivingOfEmails bit,&#xD;&#xA;&#x9;@WebViewMaxHeight smallint , &#xD;&#xA;&#x9;@WebViewMaxWidth smallint&#xD;&#xA;) &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100View" Name="[dbo].[UserView]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
SELECT     UserId, FirstName, LastName, Password, Email, CreateDate, DisplayName, Deleted, Username, CurrentSession, LastLogin, AccountStatus, EnableReceivingOfEmails, 
                      WebViewMaxHeight, WebViewMaxWidth
FROM         dbo.[User]]]></Value>
			</Property>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[UserId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[UserId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[FirstName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[FirstName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[LastName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[LastName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[Password]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Password]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[Email]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Email]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[CreateDate]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[CreateDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[DisplayName]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[DisplayName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[Deleted]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Deleted]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[Username]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[Username]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[CurrentSession]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[CurrentSession]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[LastLogin]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[LastLogin]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[AccountStatus]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[AccountStatus]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[EnableReceivingOfEmails]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[WebViewMaxHeight]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[WebViewMaxHeight]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql90ComputedColumn" Name="[dbo].[UserView].[WebViewMaxWidth]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[User].[WebViewMaxWidth]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[User]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[CreateDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[DisplayName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Deleted]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[CurrentSession]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[LastLogin]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[AccountStatus]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[EnableReceivingOfEmails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxHeight]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[User].[WebViewMaxWidth]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="280" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW dbo.UserView&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[Viewed]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Viewed].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Viewed].[MediaId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[Viewed].[ViewedDateTime]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Table" Name="[dbo].[WaitingList]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[WaitingList].[WaitingListId]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[WaitingList].[EmailAddress]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="ISql100SimpleColumn" Name="[dbo].[WaitingList].[CreateDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Precision" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql100Procedure" Name="[dbo].[WaitingList_Insert]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	Insert INTO WaitingList(EmailAddress)Values(@EmailAddress)
END]]></Value>
			</Property>
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WaitingList]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WaitingList].[EmailAddress]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WaitingList_Insert].[@EmailAddress]" />
				</Entry>
			</Relationship>
			<Relationship Name="Owner">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="ISql100SubroutineParameter" Name="[dbo].[WaitingList_Insert].[@EmailAddress]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="ISql90TypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="563" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE WaitingList_Insert &#xD;&#xA;&#x9;-- Add the parameters for the stored procedure here&#xD;&#xA;(&#xD;&#xA;&#x9;@EmailAddress nvarchar(150)&#xD;&#xA;)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[CommentView].[MS_DiagramPane1]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "Comment"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 298
               Right = 203
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "Media"
            Begin Extent = 
               Top = 6
               Left = 241
               Bottom = 252
               Right = 401
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End']]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[CommentView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[CommentView].[MS_DiagramPaneCount]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[CommentView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[CurrentMediaDetailsView].[MS_DiagramPane1]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "MediaLedger"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 246
               Right = 391
            End
            DisplayFlags = 344
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End']]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[CurrentMediaDetailsView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[CurrentMediaDetailsView].[MS_DiagramPaneCount]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[CurrentMediaDetailsView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[FileView].[MS_DiagramPane1]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "File"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 188
               Right = 206
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "MediaFile_1"
            Begin Extent = 
               Top = 6
               Left = 244
               Bottom = 205
               Right = 404
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End']]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[FileView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[FileView].[MS_DiagramPaneCount]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[FileView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[FriendView].[MS_DiagramPane1]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[8] 2[45] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 11
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End']]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[FriendView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[FriendView].[MS_DiagramPaneCount]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[FriendView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[MediaView].[MS_DiagramPane1]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[20] 2[26] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 17
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End']]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISqlExtendedProperty" Name="[ISqlView].[dbo].[MediaView].[MS_DiagramPaneCount]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[MediaView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90File" Name="[ThePhotoProject]">
			<Property Name="FileName" Value="C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\ThePhotoProject.mdf" />
			<Property Name="Size" Value="13312" />
			<Property Name="SizeUnit" Value="3" />
			<Property Name="MaxSizeUnit" Value="0" />
			<Property Name="FileGrowth" Value="1024" />
			<Property Name="FileGrowthUnit" Value="3" />
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="ISql90File" Name="[ThePhotoProject_log]">
			<Property Name="FileName" Value="C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\ThePhotoProject_log.ldf" />
			<Property Name="Size" Value="7616" />
			<Property Name="SizeUnit" Value="3" />
			<Property Name="MaxSize" Value="2097152" />
			<Property Name="IsUnlimited" Value="False" />
			<Property Name="FileGrowth" Value="10" />
			<Property Name="FileGrowthUnit" Value="1" />
			<Property Name="IsLogFile" Value="True" />
		</Element>
	</Model>
</DataSchemaModel>